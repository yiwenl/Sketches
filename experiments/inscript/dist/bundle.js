/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,t,n={427:e=>{"use strict";e.exports=function(){try{return!!new Blob}catch(e){return!1}}()},42:(e,t,n)=>{"use strict";var o=n(187).EventEmitter;function r(){o.call(this),this.setMaxListeners(20)}r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()},e.exports=r},622:(e,t,n)=>{"use strict";var o=n(42),r=n(388),i=0;e.exports=function e(t){var n,s={},a=[],c=[],u=0,l=0,h={},f=function(o){return Array.isArray(o)?(o.forEach(f),n):((i=o.assets&&Array.isArray(o.assets)?e(x(o,t)):r(x(o,t))).once("destroy",p),c.push(i),h[i.id]=i,n);var i},v=function(e){return arguments.length?s[e]?s[e]:h[e]:a},x=function(e,t){return"string"==typeof e&&(e={url:e}),void 0===e.isTouchLocked&&(e.isTouchLocked=t.isTouchLocked),void 0===e.blob&&(e.blob=t.blob),void 0===e.basePath&&(e.basePath=t.basePath),e.id=e.id||e.url||String(++i),e.type=e.type||(n=e.url)&&n.split("?")[0].split(".").pop().toLowerCase(),e.crossOrigin=e.crossOrigin||t.crossOrigin,e.webAudioContext=e.webAudioContext||t.webAudioContext,e.log=t.log,e;var n},d=function(e){var t=u+e;n.emit("progress",t/l)},_=function(e,t,o){Array.isArray(e)&&(e={id:t,file:e,type:o}),u++,n.emit("progress",u/l),s[e.id]=e.file,a.push(e),n.emit("childcomplete",e),E()},m=function(e){l--,n.listeners("error").length?n.emit("error",e):console.error(e),E()},p=function(e){h[e]=null,delete h[e],s[e]=null,delete s[e],a.some((function(t,n){if(t.id===e)return a.splice(n,1),!0}))},E=function(){u>=l&&n.emit("complete",a,s,t.id,"group")};return n=Object.create(o.prototype,{_events:{value:{}},id:{get:function(){return t.id}},add:{value:f},start:{value:function(){return l=c.length,c.forEach((function(e){e.on("progress",d).once("complete",_).once("error",m).start()})),c=[],n}},get:{value:v},find:{value:function(e){if(v(e))return v(e);var t=null;return Object.keys(h).some((function(n){return!!(t=h[n].find&&h[n].find(e))})),t}},getLoader:{value:function(e){return h[e]}},loaded:{get:function(){return u>=l}},file:{get:function(){return a}},destroy:{value:function(){for(;c.length;)c.pop().destroy();return n.off("error"),n.off("progress"),n.off("complete"),a=[],s={},t.webAudioContext=null,l=0,u=0,Object.keys(h).forEach((function(e){h[e].destroy()})),h={},n.emit("destroy",n.id),n}}}),t=x(t||{},{basePath:"",blob:!1,touchLocked:!1,crossOrigin:null,webAudioContext:null,log:!1}),Array.isArray(t.assets)&&f(t.assets),n}},719:(e,t,n)=>{"use strict";var o=n(622);o.stats=n(795),e.exports=o},388:(e,t,n)=>{"use strict";var o=n(42),r=n(427),i=n(795);e.exports=function(e){var t,n,s,a,c,u,l=e.id,h=e.basePath||"",f=e.url,v=e.type,x=e.crossOrigin,d=e.isTouchLocked,_=e.blob&&r,m=e.webAudioContext,p=e.log,E=function(e){e&&(u={id:l,file:e,type:v},t.emit("progress",1),t.emit("complete",u,l,v),I())},T=function(e,t){n=t||y,(s=new XMLHttpRequest).open("GET",h+f,!0),s.responseType=e,s.addEventListener("progress",g),s.addEventListener("load",n),s.addEventListener("error",w),s.send()},g=function(e){e.lengthComputable&&t.emit("progress",e.loaded/e.total)},y=function(){R()&&E(s.response)},R=function(){return s&&s.status<400?(i.update(s,a,f,p),!0):(w(s&&s.statusText),!1)},A=function(){s=new Image,x&&(s.crossOrigin="anonymous"),s.addEventListener("error",w,!1),s.addEventListener("load",C,!1),s.src=h+f},C=function(e){window.clearTimeout(c),e||!s.error&&s.readyState?E(s):w()},S=function(){T("blob",(function(){R()&&((s=new Image).addEventListener("error",w,!1),s.addEventListener("load",b,!1),s.src=window.URL.createObjectURL(s.response))}))},b=function(){window.URL.revokeObjectURL(s.src),E(s)},M=function(){T("arraybuffer",(function(){R()&&m.decodeAudioData(s.response,(function(e){s=null,E(e)}),(function(e){w(e)}))}))},L=function(e){s=document.createElement(e),d||(window.clearTimeout(c),c=window.setTimeout(C,2e3),s.addEventListener("canplaythrough",C,!1)),s.addEventListener("error",w,!1),s.preload="auto",s.src=h+f,s.load(),d&&E(s)},w=function(e){window.clearTimeout(c);var n=e;s&&s.tagName&&s.error?n="MediaError: "+["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"][s.error.code]+" "+s.src:s&&s.statusText?n=s.statusText:e&&e.message?n=e.message:e&&e.type&&(n=e.type),t.emit("error",'Error loading "'+h+f+'" '+n),N()},I=function(){t.off("error"),t.off("progress"),t.off("complete"),s&&(s.removeEventListener("progress",g),s.removeEventListener("load",n),s.removeEventListener("error",w),s.removeEventListener("load",C),s.removeEventListener("canplaythrough",C),s.removeEventListener("load",b))},N=function(){I(),s&&s.abort&&s.readyState<4&&s.abort(),s=null,m=null,u=null,window.clearTimeout(c),t.emit("destroy",l)};return t=Object.create(o.prototype,{_events:{value:{}},id:{value:e.id},start:{value:function(){switch(a=Date.now(),v){case"json":T("json",(function(){if(R()){var e=s.response;"string"==typeof e&&(e=JSON.parse(e)),E(e)}}));break;case"jpg":case"png":case"gif":case"webp":case"svg":_?S():A();break;case"mp3":case"ogg":case"opus":case"wav":case"m4a":m?M():L("audio");break;case"ogv":case"mp4":case"webm":case"hls":_?T("blob"):L("video");break;case"bin":case"binary":T("arraybuffer");break;case"txt":case"text":T("text");break;default:throw"AssetsLoader ERROR: Unknown type for file with URL: "+h+f+" ("+v+")"}}},loaded:{get:function(){return!!u}},file:{get:function(){return u}},destroy:{value:N}})}},795:e=>{"use strict";e.exports={mbs:0,secs:0,update:function(e,t,n,o){var r,i=e.getAllResponseHeaders();if(i){var s=i.match(/content-length: (\d+)/i);s&&s.length&&(r=s[1])}if(r){var a=(r=parseInt(r,10))/1024/1024,c=(Date.now()-t)/1e3;this.secs+=c,this.mbs+=a,o&&this.log(n,a,c)}else o&&console.warn.call(console,"Can't get Content-Length:",n)},log:function(e,t,n){if(e){var o="File loaded: "+e.substr(e.lastIndexOf("/")+1)+" size:"+t.toFixed(2)+"mb time:"+n.toFixed(2)+"s speed:"+(t/n).toFixed(2)+"mbps";console.log.call(console,o)}var r="Total loaded: "+this.mbs.toFixed(2)+"mb time:"+this.secs.toFixed(2)+"s speed:"+this.getMbps().toFixed(2)+"mbps";console.log.call(console,r)},getMbps:function(){return this.mbs/this.secs}}},187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,o){function r(n){e.removeListener(t,i),o(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}d(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&d(e,"error",t,{once:!0})}(e,r)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,n,o){var r,i,s,u;if(a(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=o?[n,s]:[s,n]:o?s.unshift(n):s.push(n),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(o);return r.listener=n,o.wrapFn=r,r}function f(e,t,n){var o=e._events;if(void 0===o)return[];var r=o[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):x(r,r.length)}function v(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function x(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function d(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(i){o.once&&e.removeEventListener(t,r),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var u=c.length,l=x(c,u);for(n=0;n<u;++n)o(l[n],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,o,r,i,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,r=i;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,i=Object.keys(n);for(o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},i.prototype.listenerCount=v,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},685:(e,t,n)=>{"use strict";n.d(t,{Ib:()=>o,WT:()=>r,fS:()=>i});var o=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;function i(e,t){return Math.abs(e-t)<=o*Math.max(1,Math.abs(e),Math.abs(t))}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},975:(e,t,n)=>{"use strict";n.d(t,{G3:()=>_,Iu:()=>l,JG:()=>i,Jp:()=>u,M5:()=>m,U_:()=>c,Ue:()=>r,al:()=>s,bA:()=>h,dC:()=>E,en:()=>d,jI:()=>x,lM:()=>f,uD:()=>v,yR:()=>a,zB:()=>p});var o=n(685);function r(){var e=new o.WT(16);return o.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function s(e,t,n,r,i,s,a,c,u,l,h,f,v,x,d,_){var m=new o.WT(16);return m[0]=e,m[1]=t,m[2]=n,m[3]=r,m[4]=i,m[5]=s,m[6]=a,m[7]=c,m[8]=u,m[9]=l,m[10]=h,m[11]=f,m[12]=v,m[13]=x,m[14]=d,m[15]=_,m}function a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e,t){var n=t[0],o=t[1],r=t[2],i=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=t[8],h=t[9],f=t[10],v=t[11],x=t[12],d=t[13],_=t[14],m=t[15],p=n*a-o*s,E=n*c-r*s,T=n*u-i*s,g=o*c-r*a,y=o*u-i*a,R=r*u-i*c,A=l*d-h*x,C=l*_-f*x,S=l*m-v*x,b=h*_-f*d,M=h*m-v*d,L=f*m-v*_,w=p*L-E*M+T*b+g*S-y*C+R*A;return w?(w=1/w,e[0]=(a*L-c*M+u*b)*w,e[1]=(r*M-o*L-i*b)*w,e[2]=(d*R-_*y+m*g)*w,e[3]=(f*y-h*R-v*g)*w,e[4]=(c*S-s*L-u*C)*w,e[5]=(n*L-r*S+i*C)*w,e[6]=(_*T-x*R-m*E)*w,e[7]=(l*R-f*T+v*E)*w,e[8]=(s*M-a*S+u*A)*w,e[9]=(o*S-n*M-i*A)*w,e[10]=(x*y-d*T+m*p)*w,e[11]=(h*T-l*y-v*p)*w,e[12]=(a*C-s*b-c*A)*w,e[13]=(n*b-o*C+r*A)*w,e[14]=(d*E-x*g-_*p)*w,e[15]=(l*g-h*E+f*p)*w,e):null}function u(e,t,n){var o=t[0],r=t[1],i=t[2],s=t[3],a=t[4],c=t[5],u=t[6],l=t[7],h=t[8],f=t[9],v=t[10],x=t[11],d=t[12],_=t[13],m=t[14],p=t[15],E=n[0],T=n[1],g=n[2],y=n[3];return e[0]=E*o+T*a+g*h+y*d,e[1]=E*r+T*c+g*f+y*_,e[2]=E*i+T*u+g*v+y*m,e[3]=E*s+T*l+g*x+y*p,E=n[4],T=n[5],g=n[6],y=n[7],e[4]=E*o+T*a+g*h+y*d,e[5]=E*r+T*c+g*f+y*_,e[6]=E*i+T*u+g*v+y*m,e[7]=E*s+T*l+g*x+y*p,E=n[8],T=n[9],g=n[10],y=n[11],e[8]=E*o+T*a+g*h+y*d,e[9]=E*r+T*c+g*f+y*_,e[10]=E*i+T*u+g*v+y*m,e[11]=E*s+T*l+g*x+y*p,E=n[12],T=n[13],g=n[14],y=n[15],e[12]=E*o+T*a+g*h+y*d,e[13]=E*r+T*c+g*f+y*_,e[14]=E*i+T*u+g*v+y*m,e[15]=E*s+T*l+g*x+y*p,e}function l(e,t,n){var o,r,i,s,a,c,u,l,h,f,v,x,d=n[0],_=n[1],m=n[2];return t===e?(e[12]=t[0]*d+t[4]*_+t[8]*m+t[12],e[13]=t[1]*d+t[5]*_+t[9]*m+t[13],e[14]=t[2]*d+t[6]*_+t[10]*m+t[14],e[15]=t[3]*d+t[7]*_+t[11]*m+t[15]):(o=t[0],r=t[1],i=t[2],s=t[3],a=t[4],c=t[5],u=t[6],l=t[7],h=t[8],f=t[9],v=t[10],x=t[11],e[0]=o,e[1]=r,e[2]=i,e[3]=s,e[4]=a,e[5]=c,e[6]=u,e[7]=l,e[8]=h,e[9]=f,e[10]=v,e[11]=x,e[12]=o*d+a*_+h*m+t[12],e[13]=r*d+c*_+f*m+t[13],e[14]=i*d+u*_+v*m+t[14],e[15]=s*d+l*_+x*m+t[15]),e}function h(e,t,n){var o=n[0],r=n[1],i=n[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f(e,t,n){var o=Math.sin(n),r=Math.cos(n),i=t[4],s=t[5],a=t[6],c=t[7],u=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*r+u*o,e[5]=s*r+l*o,e[6]=a*r+h*o,e[7]=c*r+f*o,e[8]=u*r-i*o,e[9]=l*r-s*o,e[10]=h*r-a*o,e[11]=f*r-c*o,e}function v(e,t,n){var o=Math.sin(n),r=Math.cos(n),i=t[0],s=t[1],a=t[2],c=t[3],u=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r-u*o,e[1]=s*r-l*o,e[2]=a*r-h*o,e[3]=c*r-f*o,e[8]=i*o+u*r,e[9]=s*o+l*r,e[10]=a*o+h*r,e[11]=c*o+f*r,e}function x(e,t,n){var o=Math.sin(n),r=Math.cos(n),i=t[0],s=t[1],a=t[2],c=t[3],u=t[4],l=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r+u*o,e[1]=s*r+l*o,e[2]=a*r+h*o,e[3]=c*r+f*o,e[4]=u*r-i*o,e[5]=l*r-s*o,e[6]=h*r-a*o,e[7]=f*r-c*o,e}function d(e,t){var n=t[0],o=t[1],r=t[2],i=t[3],s=n+n,a=o+o,c=r+r,u=n*s,l=o*s,h=o*a,f=r*s,v=r*a,x=r*c,d=i*s,_=i*a,m=i*c;return e[0]=1-h-x,e[1]=l+m,e[2]=f-_,e[3]=0,e[4]=l-m,e[5]=1-u-x,e[6]=v+d,e[7]=0,e[8]=f+_,e[9]=v-d,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var _=function(e,t,n,o,r){var i,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(i=1/(o-r),e[10]=(r+o)*i,e[14]=2*r*o*i):(e[10]=-1,e[14]=-2*o),e},m=function(e,t,n,o,r,i,s){var a=1/(t-n),c=1/(o-r),u=1/(i-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*a,e[13]=(r+o)*c,e[14]=(s+i)*u,e[15]=1,e};function p(e,t,n,r){var i,s,c,u,l,h,f,v,x,d,_=t[0],m=t[1],p=t[2],E=r[0],T=r[1],g=r[2],y=n[0],R=n[1],A=n[2];return Math.abs(_-y)<o.Ib&&Math.abs(m-R)<o.Ib&&Math.abs(p-A)<o.Ib?a(e):(f=_-y,v=m-R,x=p-A,i=T*(x*=d=1/Math.hypot(f,v,x))-g*(v*=d),s=g*(f*=d)-E*x,c=E*v-T*f,(d=Math.hypot(i,s,c))?(i*=d=1/d,s*=d,c*=d):(i=0,s=0,c=0),u=v*c-x*s,l=x*i-f*c,h=f*s-v*i,(d=Math.hypot(u,l,h))?(u*=d=1/d,l*=d,h*=d):(u=0,l=0,h=0),e[0]=i,e[1]=u,e[2]=f,e[3]=0,e[4]=s,e[5]=l,e[6]=v,e[7]=0,e[8]=c,e[9]=h,e[10]=x,e[11]=0,e[12]=-(i*_+s*m+c*p),e[13]=-(u*_+l*m+h*p),e[14]=-(f*_+v*m+x*p),e[15]=1,e)}var E=u},160:(e,t,n)=>{"use strict";n.d(t,{AK:()=>x,Fv:()=>v,IH:()=>l,JG:()=>c,TK:()=>y,Ue:()=>r,Zh:()=>R,al:()=>a,bA:()=>h,bI:()=>f,d9:()=>i,fF:()=>_,jI:()=>T,kC:()=>d,kE:()=>s,kK:()=>m,lM:()=>p,lu:()=>g,t8:()=>u,uD:()=>E});var o=n(685);function r(){var e=new o.WT(3);return o.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){var t=new o.WT(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(e){var t=e[0],n=e[1],o=e[2];return Math.hypot(t,n,o)}function a(e,t,n){var r=new o.WT(3);return r[0]=e,r[1]=t,r[2]=n,r}function c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function u(e,t,n,o){return e[0]=t,e[1]=n,e[2]=o,e}function l(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function h(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function f(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return n*n+o*o+r*r}function v(e,t){var n=t[0],o=t[1],r=t[2],i=n*n+o*o+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function x(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function d(e,t,n){var o=t[0],r=t[1],i=t[2],s=n[0],a=n[1],c=n[2];return e[0]=r*c-i*a,e[1]=i*s-o*c,e[2]=o*a-r*s,e}function _(e,t,n){var o=t[0],r=t[1],i=t[2],s=n[3]*o+n[7]*r+n[11]*i+n[15];return s=s||1,e[0]=(n[0]*o+n[4]*r+n[8]*i+n[12])/s,e[1]=(n[1]*o+n[5]*r+n[9]*i+n[13])/s,e[2]=(n[2]*o+n[6]*r+n[10]*i+n[14])/s,e}function m(e,t,n){var o=t[0],r=t[1],i=t[2];return e[0]=o*n[0]+r*n[3]+i*n[6],e[1]=o*n[1]+r*n[4]+i*n[7],e[2]=o*n[2]+r*n[5]+i*n[8],e}function p(e,t,n,o){var r=[],i=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],i[0]=r[0],i[1]=r[1]*Math.cos(o)-r[2]*Math.sin(o),i[2]=r[1]*Math.sin(o)+r[2]*Math.cos(o),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function E(e,t,n,o){var r=[],i=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],i[0]=r[2]*Math.sin(o)+r[0]*Math.cos(o),i[1]=r[1],i[2]=r[2]*Math.cos(o)-r[0]*Math.sin(o),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function T(e,t,n,o){var r=[],i=[];return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],i[0]=r[0]*Math.cos(o)-r[1]*Math.sin(o),i[1]=r[0]*Math.sin(o)+r[1]*Math.cos(o),i[2]=r[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}var g=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},y=function(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return Math.hypot(n,o,r)},R=s;r()},429:e=>{const t=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e);e.exports=(e,n,o)=>{let r,i,s;if(e/=360,0==n)r=i=s=o;else{const a=o<.5?o*(1+n):o+n-o*n,c=2*o-a;r=t(c,a,e+1/3),i=t(c,a,e),s=t(c,a,e-1/3)}return[Math.max(0,Math.min(Math.round(255*r),255)),Math.max(0,Math.min(Math.round(255*i),255)),Math.max(0,Math.min(Math.round(255*s),255))]}},418:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(e){o[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}()?Object.assign:function(e,i){for(var s,a,c=r(e),u=1;u<arguments.length;u++){for(var l in s=Object(arguments[u]))n.call(s,l)&&(c[l]=s[l]);if(t){a=t(s);for(var h=0;h<a.length;h++)o.call(s,a[h])&&(c[a[h]]=s[a[h]])}}return c}},529:function(e){(function(){e.exports=function(e,t,n){var o,r,i,s,a,c;if(e/=255,t/=255,n/=255,r=0,c=0,i=((s=Math.max(e,t,n))+(a=Math.min(e,t,n)))/2,s===a)r=c=0;else{switch(o=s-a,c=i>.5?o/(2-s-a):o/(s+a),s){case e:r=(t-n)/o+(t<n?6:0);break;case t:r=(n-e)/o+2;break;case n:r=(e-t)/o+4}r/=6}return[r*=360,c=100*c+"%",i=100*i+"%"]}}).call(this)},51:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});let o=window,r=60,i=performance.now(),s=0,a=0,c=i;const u=[],l=[],h=[],f=[];let v=[],x=[],d=-1,_=0;function m(){!function(){let e,t=0,n=1e3/r,o=0;for(t=0;t<u.length;t++)e=u[t],null!=e&&e.func(e.args);for(;v.length>0;)e=v.pop(),e.func(e.args);let d=performance.now();for(a=(d-i)/1e3,s=d-c,t=0;t<l.length;t++)e=l[t],d-e.time>e.delay&&(e.func(e.args),l.splice(t,1));for(d=performance.now();h.length>0;){if(e=h.shift(),o=performance.now(),!(o-d<n)){h.unshift(e);break}e.func(e.args)}for(d=performance.now();f.length>0;)e=f.shift(),o=performance.now(),o-d<n&&e.func(e.args);c=d,v=v.concat(x),x=[]}(),d=o.requestAnimationFrame(m)}m();var p={addEF:function(e,t){const n=++_;return u[n]={func:e,args:t},n},removeEF:function(e){return void 0!==u[e]&&(u[e]=null),-1},delay:function(e,t,n){const o=performance.now();l.push({func:e,args:t,delay:n,time:o})},next:function(e,t){x.push({func:e,args:t})},defer:function(e,t){h.push({func:e,args:t})},usurp:function(e,t){f.push({func:e,args:t})},setRequestAnimationFrameSource:function(e){d>-1&&window.cancelAnimationFrame(d),o=e,m()},setFrameRate:function(e){r=e},getElapsedTime:function(){return a},getDeltaTime:function(){return s}};const E=p},247:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={themeIndex:0,bgColor:[192,158,121],color0:[108,185,253],color1:[221,14,153],color2:[26,25,24],normalBlend:!1,debug:!1,numLevel:6,autoSave:!1,showThumbnail:!1,margin:100,thumbnailSize:256,background:[22,22,22],usePoseDetection:!0}},723:(e,t,n)=>{"use strict";n.d(t,{Ag:()=>B,ZR:()=>X,hG:()=>V,Cg:()=>j,Wu:()=>Q,SY:()=>$,uL:()=>D,GL:()=>R,fy:()=>z,v6:()=>H,l:()=>ne,Kj:()=>M,Tm:()=>K,xs:()=>oe,jz:()=>W});var o=n(187),r=n.n(o),i=n(418),s=n.n(i),a=n(685);function c(e,t){const n=e.getExtension(t);if(!n)return!1;const o=t.split("_")[0],r=new RegExp(`${o}$`);for(const t in n)if("function"==typeof n[t]){const o=t.replace(r,"");t.substring&&(e[o]=n[t].bind(n))}return!0}const u=["EXT_shader_texture_lod","EXT_sRGB","EXT_frag_depth","OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_element_index_uint","EXT_texture_filter_anisotropic","EXT_color_buffer_half_float","OES_vertex_array_object","WEBGL_depth_texture","ANGLE_instanced_arrays","WEBGL_color_buffer_float","WEBGL_draw_buffers","EXT_color_buffer_float"],l=(()=>{let e=!1;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0),e})(),h=(e,t)=>{if("number"==typeof e)return a.fS(e,t);if(e.length!==t.length)return!1;let n=!0;return e.forEach(((e,o)=>{n=a.fS(e,t[o])&&n})),n},f=e=>{let t,n;return e.touches?(t=e.touches[0].pageX,n=e.touches[0].pageY):(t=e.clientX,n=e.clientY),{x:t,y:n}},v={ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BROWSER_DEFAULT_WEBGL:37444,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_LOST_WEBGL:37442,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,RED:6403,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HALF_FLOAT:36193,HIGH_FLOAT:36338,HIGH_INT:36341,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NUM_COMPRESSED_TEXTURE_FORMATS:34466,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB5_A1:32855,RGB565:36194,RGBA:6408,RGBA4:32854,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_COMPILER:36346,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,UNPACK_ALIGNMENT:3317,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0,R8:33321},x={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6403:"RED",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33321:"R8",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36193:"HALF_FLOAT",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"},d={alpha:!1,depth:!0,premultipliedAlpha:!1};var _=n(975);function m(){var e=new a.WT(9);return a.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function p(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function E(e,t){if(e===t){var n=t[1],o=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=o,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function T(e,t){var n=t[0],o=t[1],r=t[2],i=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=t[8],h=l*s-a*u,f=-l*i+a*c,v=u*i-s*c,x=n*h+o*f+r*v;return x?(x=1/x,e[0]=h*x,e[1]=(-l*o+r*u)*x,e[2]=(a*o-r*s)*x,e[3]=f*x,e[4]=(l*n-r*c)*x,e[5]=(-a*n+r*i)*x,e[6]=v*x,e[7]=(-u*n+o*c)*x,e[8]=(s*n-o*i)*x,e):null}let g=0;function y(){let e,t,n=[0,0,0,0],o=0,r=0,i=0,a=(()=>{const e=document.createElement("canvas");return!(!e.getContext("experimental-webgl2")&&!e.getContext("webgl2"))})(),f=l;const y=_.Ue(),A=_.Ue(),C=_.Ue(),S=m(),b=_.Ue(),M=m();this.id="WebGLContext"+g++,this.canvas,this.gl,this.CONTEXT_LOST="contextLost",this.CONTEXT_RESTORED="contextRestored",this.shaderCount=0,this.bufferCount=0,this.textureCount=0,this.frameBufferCount=0,this.maxAnisotropy=0,this.multiRenderTargetSupport=!1,this.maxMultiRenderTargets=0,this.init=function(e,t={}){const n=s()({},d,t);if(void 0!==e){if(e instanceof HTMLCanvasElement){this.canvas=e;let o=a?"webgl2":"webgl";t.webgl1&&(o="webgl",a=!1),this.gl=e.getContext(o,n)}else window.WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?(a=!0,this.gl=e,this.canvas=e.canvas):e instanceof WebGLRenderingContext?(a=!1,this.gl=e,this.canvas=e.canvas):console.error("The source has to be one of the following : Canvas, WebGLRenderingContext or WebGL2RenderingContext");this.canvas.addEventListener("webglcontextlost",w),this.canvas.addEventListener("webglcontextrestored",I),this.extensions=(e=>{const{gl:t}=e,n=window.WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,o={};u.forEach((e=>{o[e]=t.getExtension(e)})),n||(o.OES_vertex_array_object||console.error("OES_vertex_array_object extension is not supported"),c(t,"OES_vertex_array_object"),c(t,"ANGLE_instanced_arrays"),c(t,"WEBGL_draw_buffers"));const r=o.EXT_texture_filter_anisotropic;if(r&&(e.maxAnisotropy=t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),e.multiRenderTargetSupport=!!e.gl.drawBuffers,e.multiRenderTargetSupport){const n=e.gl.MAX_DRAW_BUFFERS||o.WEBGL_draw_buffers.MAX_DRAW_BUFFERS_WEBGL;e.maxMultiRenderTargets=t.getParameter(n)}return o})(this),(e=>{for(const t in v)e[t]?console.log("already exist : ",t):e[t]=v[t];if(e.webgl2){const t=/^[^a-z]*$/;for(const n in e.gl)t.test(n)&&-1===n.indexOf("FLOAT")&&(e[n]=e.gl[n],v[n]=e.gl[n],x[e[n]]=n)}})(this),this.setSize(this.canvas.width,this.canvas.height),this.enable(this.BLEND),this.enableAlphaBlending(),this.enable(this.DEPTH_TEST),this.enable(this.CULL_FACE),this.cullFace(R.BACK)}else{const e=document.createElement("canvas");this.init(e,n)}},this.clear=function(e=0,t=0,n=0,o=0){const{gl:r}=this;r.clearColor(e,t,n,o),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)},this.setSize=function(e,t){r=Math.floor(e),i=Math.floor(t),this.canvas.width=r,this.canvas.height=i,o=r/i,this.viewport(0,0,r,i)},this.viewport=function(e,t,o,r){h(n,[e,t,o,r])||(n=[e,t,o,r],this.gl.viewport(e,t,o,r))},this.getViewport=function(){return n},this.getAspectRatio=function(){return o},this.enable=function(e){this.gl.enable(e)},this.disable=function(e){this.gl.disable(e)},this.cullFace=function(e){this.gl.cullFace(e)},this.enableAlphaBlending=function(){const{gl:e}=this;e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)},this.enableAdditiveBlending=function(){const{gl:e}=this;e.blendFunc(e.ONE,e.ONE)},this.setMatrices=function(e){t=e,this.setModelMatrix(A)},this.setModelMatrix=function(e){_.JG(C,e),void 0!==t&&(_.Jp(y,t.viewMatrix,C),p(S,y),T(S,S),E(S,S),p(M,y),T(M,M),_.U_(b,t.viewMatrix))},this.useShader=function(t){e=t,this.shaderProgram=t.shaderProgram,this.gl.useProgram(this.shaderProgram)},this.draw=function(t){if(t.length)return void t.forEach((e=>this.draw(e)));L(),e.updateUniforms(),t.bind(this);const{drawType:n}=t,{gl:o}=this;t.isInstanced?o.drawElementsInstanced(t.drawType,t.numItems,o.UNSIGNED_INT,0,t.numInstance):n===o.POINTS?o.drawArrays(n,0,t.vertexSize):o.drawElements(n,t.numItems,o.UNSIGNED_INT,0),t.unbind()},this.getCamera=function(){return t},this.destroy=function(e=!0){this.gl.getExtension("WEBGL_lose_context").loseContext(),e&&void 0!==this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)},this.__defineGetter__("width",(function(){return r})),this.__defineGetter__("height",(function(){return i})),this.__defineGetter__("webgl2",(function(){return a})),this.__defineGetter__("isMobile",(function(){return f})),this.__defineGetter__("aspectRatio",(function(){return o}));const L=()=>{void 0!==t&&(e.uniform("uProjectionMatrix","mat4",t.projectionMatrix),e.uniform("uViewMatrix","mat4",t.viewMatrix),e.uniform("uNormalMatrix","mat3",S),e.uniform("uModelViewMatrixInverse","mat3",M)),e.uniform("uModelMatrix","mat4",C)},w=()=>{this.emit(this.CONTEXT_LOST)},I=()=>{this.emit(this.CONTEXT_RESTORED)}}y.prototype=Object.assign(Object.create(r().prototype),{constructor:y});const R=new y,A={float:"uniform1f",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1i",ivec2:"uniform2i",ivec3:"uniform3i",ivec4:"uniform4i",mat2:"uniformMatrix2fv",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv"},C=e=>"number"==typeof e?e:e.slice?e.slice(0):new Float32Array(e),S=e=>"object"==typeof e?function(e){return 9===e.length?"mat3":16===e.length?"mat4":`vec${e.length}`}(e):"float";function b(e,t){let n;this.vertexShader=e||"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nout vec2 vTextureCoord;\nout vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}",this.fragmentShader=t||"precision highp float;\n#define GLSLIFY 1\n// varying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_FragColor = vec4(1.0);\n}",this.shaderProgram;let o={};this.bind=function(e){if(void 0===e||void 0===n||e===n){if(n=e||R,!this.shaderProgram){const e=r(this.vertexShader,!0),t=r(this.fragmentShader,!1);i(e,t)}n.useShader(this)}else console.error("this shader has been bind to a different WebGL Rendering Context",n.id)},this.uniform=function(e,t,n){let r,i;void 0===n?(i=S(t),r=t):(i=t,r=n);const s=A[i];if(o[e]){const t=o[e];h(t.value,r)||(t.value=C(r),t.changed=!0)}else o[e]={type:i,uniformType:s,value:C(r),changed:!0};return this},this.updateUniforms=function(){if(!n)return void console.warn("No WebGL Context has been set yet, please call shader.bind() first");const{gl:e}=n;for(let t in o){const n=o[t];if(n.changed){const o=t;n.uniformLoc||(n.uniformLoc=e.getUniformLocation(this.shaderProgram,o));const{uniformLoc:r,uniformType:i,value:s}=n;null!==r&&(-1===i.indexOf("Matrix")?e[i](r,s):e[i](r,!1,s)),n.changed=!1}}},this.destroy=function(){const{gl:e}=n;e.deleteProgram(this.shaderProgram),n.shaderCount--};const r=(e,t)=>{const{gl:o}=n,r=t?n.VERTEX_SHADER:n.FRAGMENT_SHADER,i=o.createShader(r);return o.shaderSource(i,e),o.compileShader(i),o.getShaderParameter(i,o.COMPILE_STATUS)?i:(console.warn("Error in Shader : ",o.getShaderInfoLog(i)),console.log((e=>{const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=`${e+1}: ${t[e]}`;return t.join("\n")})(e)),null)},i=(e,t)=>{const{gl:o}=n;this.shaderProgram=o.createProgram(),o.attachShader(this.shaderProgram,e),o.attachShader(this.shaderProgram,t),o.deleteShader(e),o.deleteShader(t),o.linkProgram(this.shaderProgram),n.shaderCount++}}function M(e=v.TRIANGLES){this.drawType=e,this.numItems=0;let t,n,o,r,i,s=[],a=[],c=[],u=!0,l=!1,h=0;this.bufferData=function(e,t,n,o=v.STATIC_DRAW,r=!1){let i,s=[];if("number"==typeof e[0]){if(i=e,void 0===n)return console.error("Missing element size for flatten data :",t),this;for(let e=0;e<i.length;e+=n){const t=[];for(let o=0;o<n;o++)t.push(i[e+o]);s.push(t)}}else s=e,i=(a=e)[0]instanceof Float32Array?a.reduce(((e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n]);return e}),[]):a.flat();var a;const c=void 0===n?e[0].length:n;return f(i,e,t,c,o,r)},this.bufferInstance=function(e,t){const n=e[0].length;return h=e.length,this.bufferData(e,t,n,v.STATIC_DRAW,!0)},this.bufferVertex=function(e,t=v.STATIC_DRAW){return this.bufferData(e,"aVertexPosition",3,t)},this.bufferTexCoord=function(e,t=v.STATIC_DRAW){return this.bufferData(e,"aTextureCoord",2,t)},this.bufferNormal=function(e,t=v.STATIC_DRAW){return this.bufferData(e,"aNormal",3,t)},this.bufferIndex=function(e,t=v.STATIC_DRAW){return n=t,o=new Uint32Array(e),this.numItems=o.length,u=!0,this},this.bind=function(e){if(void 0!==e&&void 0!==i&&e!==i)return void console.error("this mesh has been bind to a different WebGL Rendering Context");i=e||GL;const{gl:n}=i;x(),n.bindVertexArray(t),this.vertexSize=this.getSource("aVertexPosition").length},this.unbind=function(){},this.getAttribute=function(e){return s.find((t=>t.name===e))},this.getAttributes=function(){return s},this.getSource=function(e){const t=this.getAttribute(e);return t?t.source:[]},this.generateFaces=function(){let e,t,n,r,i,s;c=[];const{vertices:a}=this;for(let u=0;u<o.length;u+=3){e=o[u],t=o[u+1],n=o[u+2],r=a[e],i=a[t],s=a[n];const l={indices:[e,t,n],vertices:[r,i,s]};c.push(l)}},this.destroy=function(){const{gl:e}=i;s.forEach((t=>{e.deleteBuffer(t.buffer),t.source=[],t.dataArray=[],i.bufferCount--})),r&&(e.deleteBuffer(r),i.bufferCount--),e.deleteVertexArray(t),s=[],o=[],a=[]},this.__defineGetter__("vertices",(function(){return this.getSource("aVertexPosition")})),this.__defineGetter__("coords",(function(){return this.getSource("aTextureCoord")})),this.__defineGetter__("normal",(function(){return this.getSource("aNormal")})),this.__defineGetter__("indices",(function(){return o})),this.__defineGetter__("faces",(function(){return c})),this.__defineGetter__("isInstanced",(function(){return l})),this.__defineGetter__("numInstance",(function(){return h}));const f=(e,t,n,o,r=v.STATIC_DRAW,i=!1)=>{const c=r;l=i||l;const u=new Float32Array(e),h=this.getAttribute(n);return h?(h.itemSize=o,h.dataArray=u,h.source=t):s.push({name:n,source:t,itemSize:o,usage:c,dataArray:u,isInstanced:i}),a.push(n),this},x=()=>{const{shaderProgram:e,gl:n}=i;0!=a.length&&(t||(t=n.createVertexArray()),n.bindVertexArray(t),s.forEach((t=>{if(-1!==a.indexOf(t.name)){const o=function(e,t){let n;const{gl:o}=t;return void 0!==e.buffer?n=e.buffer:(n=o.createBuffer(),e.buffer=n,t.bufferCount++),n}(t,i);n.bindBuffer(n.ARRAY_BUFFER,o),n.bufferData(n.ARRAY_BUFFER,t.dataArray,t.usage);const r=((e,t,n)=>(void 0===t.cacheAttribLoc&&(t.cacheAttribLoc={}),void 0===t.cacheAttribLoc[n]&&(t.cacheAttribLoc[n]=e.getAttribLocation(t,n)),t.cacheAttribLoc[n]))(n,e,t.name);r>=0&&(n.enableVertexAttribArray(r),n.vertexAttribPointer(r,t.itemSize,n.FLOAT,!1,0,0)),t.attrPosition=r,t.isInstanced&&n.vertexAttribDivisor(r,1)}})),d(),n.bindVertexArray(null),u=!1,a=[])},d=()=>{const{gl:e}=i;u&&(r||(r=e.createBuffer(),i.bufferCount++),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o,n))}}const L=e=>0!==e&&!(e&e-1);class w{constructor(e){this._value=e}set(e,t=1){this._value=this._value,this._value=0===t?this._value&0<<e:this._value|1<<e}get(e){let t=this._value&1<<e;return t>>=e,1===t}reset(e){this._value=e}get value(){return this._value}}const I="This browser doesn't support multi render targets : WEBGL_draw_buffers",N="This framebuffer has been bind to a different WebGL Rendering Context",P="This texture has been bind to a different WebGL Rendering Context",F=(e,t="")=>{console.error(e,t)};class z{constructor(e,t={},n=0,o=0){if(this._fromWebGLTexture=!1,e instanceof WebGLTexture)this._texture=e,this._fromWebGLTexture=!0;else{if(this._source=e,this._isHtmlElement=(e=>e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement)(this._source),!this._isHtmlElement&&e&&!((e,t)=>{let n=!0;return"Array"===e.constructor.name&&(console.error("Please convert texture source to Unit8Array or Float32Array"),n=!1),void 0===t.type&&"Uint8Array"!==e.constructor.name&&console.error("Using none Unit8Array, pleaes specify type in the texture parameters"),n})(e,t))return;this._getDimension(e,n,o),this._params=function(e,t,n){if(!e.minFilter){let o=v.LINEAR;t&&t&&L(t)&&L(n)&&(o=v.NEAREST_MIPMAP_LINEAR),e.minFilter=o}return e.mipmap=void 0===e.mipmap||e.mipmap,e.magFilter=e.magFilter||v.LINEAR,e.wrapS=e.wrapS||v.CLAMP_TO_EDGE,e.wrapT=e.wrapT||v.CLAMP_TO_EDGE,e.internalFormat=e.internalFormat||v.RGBA,e.format=e.format||v.RGBA,e.premultiplyAlpha=void 0!==e.premultiplyAlpha&&e.premultiplyAlpha,e.level=e.level||0,e.type=e.type||v.UNSIGNED_BYTE,e}(t,this._width,this._height),this._checkMipmap()}this._parametersState=new w(0)}bind(e,t){if(void 0!==t&&void 0!==this.GL&&t!==this.GL)return void F(P,this.GL.id);this.GL=t||R;const{gl:n}=this.GL;this._fromWebGLTexture||this.createTexture(this.GL),n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,this._texture),this._checkParameters()}createTexture(e){void 0===e||void 0===this.GL||e===this.GL?(this.GL=e||R,this._texture||(((e,t)=>{e.webgl2&&(t.type===v.HALF_FLOAT?(t.type=e.gl.HALF_FLOAT,t.internalFormat=v.RGBA16F):t.type===v.FLOAT&&(t.internalFormat=v.RGBA32F))})(this.GL,this._params),this._uploadTexture())):F(P,this.GL.id)}updateTexture(e,t){this.GL=t||R,this._source=e,this._uploadTexture()}generateMipmap(){if(!this._generateMipmap)return;const{gl:e}=this.GL;e.bindTexture(e.TEXTURE_2D,this._texture),e.generateMipmap(e.TEXTURE_2D)}destroy(){const{gl:e}=this.GL;e.deleteTexture(this._texture),this.GL.textureCount--}showProperties(){console.log("Dimension :",this._width,this._height);for(const e in this._params)console.log(e,x[this._params[e]]||this._params[e])}_uploadTexture(){const{gl:e}=this.GL;this._texture||(this._texture=e.createTexture(),this.GL.textureCount++),e.bindTexture(e.TEXTURE_2D,this._texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),this._isHtmlElement&&!this.GL.webgl2?e.texImage2D(e.TEXTURE_2D,0,this._params.internalFormat,this._params.format,this._params.type,this._source):e.texImage2D(e.TEXTURE_2D,0,this._params.internalFormat,this._width,this._height,0,this._params.format,this._params.type,this._source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._params.magFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._params.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._params.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._params.wrapT),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha),this._generateMipmap&&e.generateMipmap(e.TEXTURE_2D)}_checkParameters(){const{gl:e}=this.GL;this._parametersState.value>0&&(this._parametersState.get(0)?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this._params.minFilter):this._parametersState.get(1)?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,this._params.magFilter):this._parametersState.get(2)?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._params.wrapS):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._params.wrapT)),this._parametersState.reset(0)}_getDimension(e,t,n){e?(this._width=e.width||e.videoWidth,this._height=e.height||e.videoWidth,this._width=this._width||t,this._height=this._height||n,this._width&&this._height||(this._width=this._height=Math.sqrt(e.length/4))):(this._width=t,this._height=n)}_checkMipmap(){this._generateMipmap=this._params.mipmap,L(this._width)&&L(this._height)||(this._generateMipmap=!1),-1===x[this._params.minFilter].indexOf("MIPMAP")&&(this._generateMipmap=!1)}get texture(){return this._texture}set minFilter(e){this._params.minFilter=e,this._parametersState.set(0,1)}get minFilter(){return this._params.minFilter}set magFilter(e){this._params.magFilter=e,this._parametersState.set(1,1)}get magFilter(){return this._params.magFilter}set wrapS(e){this._params.wrapS=e,this._parametersState.set(2,1)}get wrapS(){return this._params.wrapS}set wrapT(e){this._params.wrapT=e,this._parametersState.set(3,1)}get wrapT(){return this._params.wrapT}get width(){return this._width}get height(){return this._height}get glTexture(){return this._texture}}function D(e,t,n={},o=1){let r,i;const s=e,a=t,c=n,u=o,l=[];let h;this.bind=function(e,t=!0){if(void 0!==e&&void 0!==r&&e!==r)return void F(N,r.id);r=e||R;const{gl:n}=r;u>1&&!r.multiRenderTargetSupport&&F(I,r.id),i||f(),t&&r.viewport(0,0,s,a),n.bindFramebuffer(n.FRAMEBUFFER,i)},this.unbind=function(e=!0){e&&r.viewport(0,0,r.width,r.height);const{gl:t}=r;t.bindFramebuffer(t.FRAMEBUFFER,null),l.forEach((e=>{e.generateMipmap()}))},this.getTexture=function(e=0){return l[e]},this.destroy=function(){const{gl:e}=r;l.forEach((e=>e.destroy())),h.destroy(),e.deleteFramebuffer(i),r.frameBufferCount--};const f=()=>{x();const{gl:e}=r;i=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,i),r.frameBufferCount++;const t=r.webgl2?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,n=[];for(let o=0;o<u;o++)e.framebufferTexture2D(t,e.COLOR_ATTACHMENT0+o,e.TEXTURE_2D,l[o].texture,0),n.push(v[`COLOR_ATTACHMENT${o}`]);r.multiRenderTargetSupport&&e.drawBuffers(n),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,h.texture,0),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)},x=()=>{for(let e=0;e<u;e++)l.push(d());const{gl:e}=r,t=r.webgl2?e.DEPTH_COMPONENT16:e.DEPTH_COMPONENT;h=d(t,v.UNSIGNED_INT,v.DEPTH_COMPONENT,{minFilter:v.NEAREST,magFilter:v.NEAREST,mipmap:!1})},d=(e,t,n,o={})=>{const i=Object.assign({},c);n||(n=e),i.internalFormat=e||v.RGBA,i.format=n||v.RGBA,i.type=t||i.type,Object.assign(i,o);const u=new z(null,i,s,a);return u.createTexture(r),u};this.__defineGetter__("texture",(function(){return l[0]})),this.__defineGetter__("depthTexture",(function(){return h})),this.__defineGetter__("width",(function(){return s})),this.__defineGetter__("height",(function(){return a}))}var U=n(160);class O{constructor(){this._mtx=_.Ue(),this._mtxView=_.Ue(),this._mtxProj=_.Ue(),this._near=0,this._far=0,this._lookDir=U.Ue()}lookAt(e,t,n=[0,1,0]){_.zB(this._mtxView,e,t,n)}setFromViewProjection(e,t){_.JG(this._mtxView,e),_.JG(this._mtxProj,t)}setViewMatrix(e){_.JG(this._mtxView,e)}setProjectionMatrix(e){_.JG(this._mtxProj,e)}_updateMatrices(){}get matrix(){return _.dC(this._mtx,this._mtxProj,this._mtxView),this._mtx}get viewMatrix(){return this._mtxView}get view(){return this._mtxView}get projectionMatrix(){return this._mtxProj}get projection(){return this._mtxProj}get position(){const e=_.Ue();return _.U_(e,this._mtxView),[e[12],e[13],e[14]]}get direction(){const e=m();return p(e,this._mtxView),E(e,e),U.kK(this._lookDir,[0,0,-1],e),U.Fv(this._lookDir,this._lookDir),this._lookDir}set near(e){this._near=e,this._updateMatrices()}get near(){return this._near}set far(e){this._far=e,this._updateMatrices()}get far(){return this._far}}class B extends O{constructor(e,t,n,o,r=.1,i=100){super(),this._left=0,this._right=0,this._top=0,this._bottom=0,this.ortho(e,t,n,o,r,i)}ortho(e,t,n,o,r=.1,i=100){this.left=e,this.right=t,this.top=n,this.bottom=o,_.M5(this._mtxProj,e,t,o,n,r,i),this._left=e,this._right=t,this._top=n,this._bottom=o,this._near=r,this._far=i}_updateMatrices(){this.ortho(this._left,this._right,this._top,this._bottom,this._near,this._far)}}function G(e,t){this.origin=e,this.direction=t;const n=U.Ue(),o=U.Ue(),r=U.Ue(),i=U.Ue(),s=U.Ue(),a=U.Ue(),c=U.Ue(),u=U.Ue();this.at=function(e){return U.JG(i,this.direction),U.bA(i,i,e),U.IH(i,i,this.origin),i},this.lookAt=function(e){U.lu(this.direction,e,this.origin),U.Fv(this.origin,this.origin)},this.closestPointToPoint=function(e){const t=U.Ue();U.lu(e,this.origin);const n=U.AK(t,this.direction);return n<0?U.d9(this.origin):(U.JG(t,this.direction),U.bA(t,t,n),U.IH(t,t,this.origin),t)},this.distanceToPoint=function(e){return Math.sqrt(this.distanceSqToPoint(e))},this.distanceSqToPoint=function(e){const t=U.Ue();U.lu(t,e,this.origin);const n=U.AK(t,this.direction);return n<0?U.bI(this.origin,e):(U.JG(t,this.direction),U.bA(t,t,n),U.IH(t,t,this.origin),U.bI(t,e))},this.intersectsSphere=function(e,t){return this.distanceToPoint(e)<=t},this.intersectSphere=function(e,t){const n=U.Ue();U.lu(n,e,this.origin);const o=U.AK(n,this.direction),r=U.AK(n,n)-o*o,i=t*t;if(r>i)return null;const s=Math.sqrt(i-r),a=o-s,c=o+s;return a<0&&c<0?null:a<0?this.at(c):this.at(a)},this.intersectTriangle=function(e,t,i,l=!0){U.JG(n,e),U.JG(o,t),U.JG(r,i),U.lu(s,o,n),U.lu(a,r,n),U.kC(c,s,a);let h,f=U.AK(this.direction,c);if(f>0){if(l)return null;h=1}else{if(!(f<0))return null;h=-1,f=-f}U.lu(u,this.origin,n),U.kC(a,u,a);const v=h*U.AK(this.direction,a);if(v<0)return null;U.kC(s,s,u);const x=h*U.AK(this.direction,s);if(x<0)return null;if(v+x>f)return null;const d=-h*U.AK(u,c);return d<0?null:this.at(d/f)}}class X extends O{constructor(e,t,n,o){super(),this._fov=0,this._ratio=0,this.setPerspective(e,t,n,o)}setPerspective(e,t,n,o){_.G3(this._mtxProj,e,t,n,o),this._near=n,this._far=o,this._fov=e,this._ratio=t}setAspectRatio(e){this._ratio=e,this._updateMatrices()}generateRay(e,t){const n=_.Ue(),o=U.Ue(),r=this._mtxProj,i=this._mtxView;return _.Jp(n,r,i),_.U_(n,n),U.fF(o,e,n),U.lu(o,o,this.position),U.Fv(o,o),t?(t.origin=this.position,t.direction=o):t=new G(this.position,o),t}_updateMatrices(){this.setPerspective(this._fov,this._ratio,this._near,this._far)}}class V{constructor(e){return this._GL=e||R,this._uniforms={},this._uniformTextures=[],this._fbo,this._clearColor={r:0,g:0,b:0,a:0},this}setClearColor(e=0,t=0,n=0,o=0){return this._clearColor.r=e,this._clearColor.g=t,this._clearColor.b=n,this._clearColor.a=o,this}useProgram(e,t){return this._shader=e instanceof b?e:new b(e,t),this}setMesh(e){return this._mesh=e,this}createMesh(e){return this._mesh=new M(e),this}bufferVertex(e){return this._mesh||(this._mesh=new M),this._mesh.bufferVertex(e),this}bufferTexCoord(e){return this._mesh||(this._mesh=new M),this._mesh.bufferTexCoord(e),this}bufferNormal(e){return this._mesh||(this._mesh=new M),this._mesh.bufferNormal(e),this}bufferIndex(e){return this._mesh||(this._mesh=new M),this._mesh.bufferIndex(e),this}bufferInstance(e,t){return this._mesh?(this._mesh.bufferInstance(e,t),this):(console.warn("Need to create mesh first"),this)}bufferData(e,t){return this._mesh||(this._mesh=new M),this._mesh.bufferData(e,t),this}uniform(e,t,n){const o=e;let r,i;return void 0===n?(i=S(t),r=t):(i=t,r=n),this._uniforms[o]={type:i,value:r},this}uniformTexture(e,t,n){return this.bindTexture(e,t,n)}bindTexture(e,t,n){return void 0!==n?this._uniformTextures[n]={name:e,texture:t}:this._uniformTextures.push({name:e,texture:t}),this}bindFrameBuffer(e){return this._fbo=e,this}draw(){if(this._shader){if(this._mesh){if(this._fbo){const{r:e,g:t,b:n,a:o}=this._clearColor;this._fbo.bind(this._GL),this._GL.clear(e,t,n,o)}this._shader.bind(this._GL);for(const e in this._uniforms){const t=this._uniforms[e];this._shader.uniform(e,t.type,t.value)}return this._uniformTextures.forEach(((e,t)=>{void 0!==e&&(this._shader.uniform(e.name,"int",t),e.texture.bind(t,this._GL))})),this._GL.draw(this._mesh),this._fbo&&this._fbo.unbind(),this}console.warn("No Mesh assigned for draw call")}else console.warn("No GLShader assigned for draw call")}get shader(){return this._shader}get framebuffer(){return this._fbo}}let k;const H={plane:(e,t,n,o="xy")=>{const r=[],i=[],s=[],a=[],c=e/n,u=t/n,l=1/n,h=.5*-e,f=.5*-t;let v=0;for(let e=0;e<n;e++)for(let t=0;t<n;t++){const x=c*e+h,d=u*t+f,_=e/n,m=t/n;"xz"===o?(r.push([x,0,d+u]),r.push([x+c,0,d+u]),r.push([x+c,0,d]),r.push([x,0,d]),i.push([_,1-(m+l)]),i.push([_+l,1-(m+l)]),i.push([_+l,1-m]),i.push([_,1-m]),a.push([0,1,0]),a.push([0,1,0]),a.push([0,1,0]),a.push([0,1,0])):"yz"===o?(r.push([0,d,x]),r.push([0,d,x+c]),r.push([0,d+u,x+c]),r.push([0,d+u,x]),i.push([_,m]),i.push([_+l,m]),i.push([_+l,m+l]),i.push([_,m+l]),a.push([1,0,0]),a.push([1,0,0]),a.push([1,0,0]),a.push([1,0,0])):(r.push([x,d,0]),r.push([x+c,d,0]),r.push([x+c,d+u,0]),r.push([x,d+u,0]),i.push([_,m]),i.push([_+l,m]),i.push([_+l,m+l]),i.push([_,m+l]),a.push([0,0,1]),a.push([0,0,1]),a.push([0,0,1]),a.push([0,0,1])),s.push(4*v+0),s.push(4*v+1),s.push(4*v+2),s.push(4*v+0),s.push(4*v+2),s.push(4*v+3),v++}return(new M).bufferVertex(r).bufferTexCoord(i).bufferIndex(s).bufferNormal(a)},bigTriangle:()=>{if(!k){const e=[2,1,0],t=[[-1,-1],[-1,4],[4,-1]];k=(new M).bufferData(t,"aPosition",2).bufferIndex(e)}return k}},W={simpleColorFrag:"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec3 uColor;\nuniform float uOpacity;\n\nout vec4 fragColor;\n\nvoid main(void) {\n    fragColor = vec4(uColor, uOpacity);\n}",copyFrag:"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\n\nout vec4 oColor;\n\nvoid main(void) {\n    oColor = texture(uMap, vTextureCoord);\n}",bigTriangleVert:"#version 300 es\n\nprecision mediump float;\n#define GLSLIFY 1\nin vec2 aPosition;\nout vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTextureCoord = aPosition * .5 + .5;\n}"};class j extends V{constructor(e){super(e),this.setMesh(H.bigTriangle()).useProgram(W.bigTriangleVert,W.copyFrag)}draw(e){this.bindTexture("texture",e,0),super.draw(0)}}var Y;function Z(){var e=new a.WT(4);return a.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}Y=new a.WT(4),a.WT!=Float32Array&&(Y[0]=0,Y[1]=0,Y[2]=0,Y[3]=0);function K(){let e=U.Ue(),t=U.Ue(),n=U.al(1,1,1),o=_.Ue(),r=_.Ue(),i=_.Ue(),s=_.Ue(),a=_.Ue(),c=_.Ue(),u=Z(),l=[],h=!0;this.update=function(e){void 0!==e&&_.JG(r,e),h=!0,f()},this.addChild=function(e){l.push(e)},this.removeChild=function(e){const t=l.indexOf(e);-1!=t?l.splice(t,1):console.warn("Child no exist")},this.setRotationFromQuaternion=function(e){(function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]})(u,e),h=!0};const f=()=>{h&&(_.yR(i,i),_.yR(a,a),_.yR(s,s),_.lM(s,s,t[0]),_.uD(s,s,t[1]),_.jI(s,s,t[2]),_.en(c,u),_.dC(s,c,s),_.bA(a,a,n),_.Iu(i,i,e),_.dC(o,i,s),_.dC(o,o,a),_.dC(o,r,o),l.forEach((e=>{e.update(o)})),h=!1)};this.__defineGetter__("matrix",(function(){return f(),o})),this.__defineSetter__("x",(function(t){e[0]=t,h=!0})),this.__defineGetter__("x",(function(){return e[0]})),this.__defineSetter__("y",(function(t){e[1]=t,h=!0})),this.__defineGetter__("y",(function(){return e[1]})),this.__defineSetter__("z",(function(t){e[2]=t,h=!0})),this.__defineGetter__("z",(function(){return e[2]})),this.__defineSetter__("scaleX",(function(e){n[0]=e,h=!0})),this.__defineGetter__("scaleX",(function(){return n[0]})),this.__defineSetter__("scaleY",(function(e){n[1]=e,h=!0})),this.__defineGetter__("scaleY",(function(){return n[1]})),this.__defineSetter__("scaleZ",(function(e){n[2]=e,h=!0})),this.__defineGetter__("scaleZ",(function(){return n[2]})),this.__defineSetter__("rotationX",(function(e){t[0]=e,h=!0})),this.__defineGetter__("rotationX",(function(){return t[0]})),this.__defineSetter__("rotationY",(function(e){t[1]=e,h=!0})),this.__defineGetter__("rotationY",(function(){return t[1]})),this.__defineSetter__("rotationZ",(function(e){t[2]=e,h=!0})),this.__defineGetter__("rotationZ",(function(){return t[2]})),this.__defineGetter__("children",(function(){return l}))}U.Ue(),U.al(1,0,0),U.al(0,1,0),Z(),Z(),m();class q{constructor(e,t,n,o={},r=1){this._fbos=[];for(let i=0;i<e;i++){const e=new D(t,n,o,r);this._fbos.push(e)}}swap(){const e=this._fbos.shift();this._fbos.push(e)}get read(){return this._fbos[this._fbos.length-1]}get write(){return this._fbos[0]}get all(){return this._fbos}}class $ extends q{constructor(e,t,n={},o=1){super(2,e,t,n,o)}}var J=n(51);class Q{constructor(e,t=.1){this.easing=t,this._value=e,this._targetValue=e,this._efIndex=J.Z.addEF((()=>this._update()))}_update(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this.easing,Math.abs(this._targetValue-this._value)<1e-4&&(this._value=this._targetValue)}setTo(e){this._targetValue=this._value=e}add(e){this._targetValue+=e}limit(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}_checkLimit(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}destroy(){J.Z.removeEF(this._efIndex)}set value(e){this._targetValue=e}get value(){return this._value}get targetValue(){return this._targetValue}}const ee=function(e,t){const n=t||{};return e.touches?(n.x=e.touches[0].pageX,n.y=e.touches[0].pageY):(n.x=e.clientX,n.y=e.clientY),n};class te{#e=!1;#t=!1;#n=!1;#o=!1;#r;#i={};#s={};#a=_.Ue();#c=_.Ue();#u=_.Ue();#l=_.Ue();#h=U.Ue();#f=U.Ue();#v=U.al(0,1,0);radius=new Q(0);rx=new Q(0);ry=new Q(0);#x=0;#d=0;constructor(e,t=5,n=window){this.#r=e,this.radius.setTo(t),this.#f=[0,0,this.radius],this.rx.limit(-Math.PI/2+.01,Math.PI/2-.01),n.addEventListener("mousewheel",this._onWheel),n.addEventListener("DOMMouseScroll",this._onWheel),n.addEventListener("mousedown",this._onDown),n.addEventListener("mousemove",this._onMove),window.addEventListener("mouseup",this._onUp),n.addEventListener("touchstart",this._onDown),n.addEventListener("touchmove",this._onMove),window.addEventListener("touchend",this._onUp),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.update(),J.Z.addEF(this._loop)}lock(e=!0){this.#e=e,this.#t=e,this.#o=!1}lockZoom(e=!0){this.#t=e}lockRotation(e=!0){this.#e=e}update(){U.t8(this.#f,0,0,this.radius.value),U.lM(this.#f,this.#f,[0,0,0],this.rx.value),U.uD(this.#f,this.#f,[0,0,0],this.ry.value),_.zB(this.#a,this.#f,this.#h,this.#v),_.U_(this.#c,this.#a),_.dC(this.#a,this.#a,this.#l),_.dC(this.#a,this.#a,this.#u),this.#r?.setViewMatrix(this.#a)}_onDown=e=>{this.#e||(this.#o=!0,ee(e,this.#i),ee(e,this.#s),this.#x=this.rx.targetValue,this.#d=this.ry.targetValue,_.yR(this.#u))};_onMove=e=>{if(this.#e)return;if(!this.#o)return;if(ee(e,this.#i),e.shiftKey){const e=[this.#i.x-this.#s.x,-(this.#i.y-this.#s.y),0];return U.fF(e,e,this.#c),U.bA(e,e,.01),_.yR(this.#u,this.#u),void _.Iu(this.#u,this.#u,e)}const t=this.#i.x-this.#s.x;this.ry.value=.01*-t+this.#d;const n=this.#i.y-this.#s.y;this.rx.value=.01*-n+this.#x};_onUp=()=>{this.#o=!1,this.#n&&(_.dC(this.#l,this.#l,this.#u),_.yR(this.#u))};_onWheel=e=>{if(this.#t)return;const t=e.wheelDelta,n=e.detail;let o=0;o=n?t?t/n/40*n>0?1:-1:-n/3:t/120,this.radius.add(2*-o),this.radius.targetValue<0&&(this.radius.value=1e-4)};_onKeyDown=e=>{e.code.indexOf("Shift")>-1&&(this.#n=!0)};_onKeyUp=e=>{"Shift"===e.key&&(_.dC(this.#l,this.#l,this.#u),_.yR(this.#u)),this.#n=!1};_loop=()=>{this.update()}}class ne extends(r()){constructor(e,t,n,o=!1,r=window){super(),this._mesh=e,this._mesh.generateFaces(),this._camera=t,this.faceVertices=e.faces.map((e=>e.vertices)),this.clickTolerance=8,this._ray=new G([0,0,0],[0,0,-1]),this._hit=U.al(-999,-999,-999),this._lastPos,this._firstPos,this.modelMatrix=_.Ue(),this.resolution=n||[window.innerWidth,window.innerHeight],this._listenerTarget=r,this._skippingMove=o,this._onMoveBind=e=>this._onMove(e),this._onDownBind=e=>this._onDown(e),this._onUpBind=()=>this._onUp(),this.connect()}connect(){this._listenerTarget.addEventListener("mousedown",this._onDownBind),this._listenerTarget.addEventListener("mousemove",this._onMoveBind),this._listenerTarget.addEventListener("mouseup",this._onUpBind)}disconnect(){this._listenerTarget.removeEventListener("mousedown",this._onDownBind),this._listenerTarget.removeEventListener("mousemove",this._onMoveBind),this._listenerTarget.removeEventListener("mouseup",this._onUpBind)}_checkHit(e="onHit"){const t=this._camera;if(!t)return;const n=this._lastPos.x/this.resolution[0]*2-1,o=-this._lastPos.y/this.resolution[1]*2+1;let r;t.generateRay([n,o,0],this._ray);const i=U.Ue(),s=U.Ue(),a=U.Ue();let c=0;const u=(e,t)=>{U.fF(t,e,this.modelMatrix)};for(let e=0;e<this.faceVertices.length;e++){const n=this.faceVertices[e];u(n[0],i),u(n[1],s),u(n[2],a);const o=this._ray.intersectTriangle(i,s,a);if(o)if(r){const e=U.TK(o,t.position);e<c&&(r=U.d9(o),c=e)}else r=U.d9(o),c=U.TK(r,t.position)}r?(this._hit=U.d9(r),this.emit(e,{hit:r})):this.emit("onUp")}_onDown(e){this._firstPos=f(e),this._lastPos=f(e),this._checkHit("onDown")}_onMove(e){this._lastPos=f(e),this._skippingMove||this._checkHit()}_onUp(){(function(e,t){const n=e.x-t.x,o=e.y-t.y;return Math.sqrt(n*n+o*o)})(this._firstPos,this._lastPos)<this.clickTolerance&&this._checkHit()}}class oe{constructor(e){this._GL=e||R,this.camera=new X,this.camera.setPerspective(45*Math.PI/180,R.aspectRatio,.1,100),this.orbitalControl=new te(this.camera,15,window),this.orbitalControl.radius.value=10,this._isRunning=!0,this._initTextures(),this._initViews(),window.addEventListener("resize",(()=>this.resize())),this._efIndex=J.Z.addEF((()=>this._loop()))}stop(){this._isRunning=!1}resume(){this._isRunning=!0}_initTextures(){}_initViews(){}update(){}render(){}_loop(){this._isRunning&&(this.update(),this._GL.viewport(0,0,this._GL.width,this._GL.height),this._GL.setMatrices(this.camera),this.render())}resize(){this._GL.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(this._GL.aspectRatio)}}n(643)},643:()=>{Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,o){return Array.isArray(o)?n.push.apply(n,e.call(o,t-1)):n.push(o),n}),[]):Array.prototype.slice.call(this)},writable:!0})},447:e=>{e.exports={TEXTURE_SIZE:128,TEXTURE_DOWNSAMPLE:2,DENSITY_DISSIPATION:.994,VELOCITY_DISSIPATION:.996,PRESSURE_DISSIPATION:.996,PRESSURE_ITERATIONS:20}},841:e=>{e.exports="precision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D textureBase;\nuniform sampler2D textureAdd;\nuniform float uStrength;\n\nvoid main(void) {\n    vec3 base = texture2D(textureBase, vTextureCoord).xyz;\n    vec3 add = texture2D(textureAdd, vTextureCoord).xyz;\n    gl_FragColor = vec4(base + add * uStrength, 1.0);\n}"},333:e=>{e.exports="precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform float uTimestep;\nuniform float uDissipation;\nuniform vec2 uTexelSize;      // 1 / grid scale \nuniform sampler2D textureVel;  // input textureVel\nuniform sampler2D textureMap;         // quantity to advect\n\nvoid main() {\n\tvec2 pos = vTextureCoord - uTimestep * uTexelSize * texture2D(textureVel, vTextureCoord).xy;\n\tgl_FragColor = uDissipation * texture2D(textureMap, pos);\n}"},110:e=>{e.exports="precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texturePressure;\nuniform float uDissipation;\n\nvoid main() {\n    gl_FragColor = uDissipation * texture2D(texturePressure, vTextureCoord);\n}"},125:e=>{e.exports="\n\nvec3 mod289(vec3 x) {\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\t}\n\nvec4 mod289(vec4 x) {\treturn x - floor(x * (1.0 / 289.0)) * 289.0;\t}\n\nvec4 permute(vec4 x) {\treturn mod289(((x*34.0)+1.0)*x);\t}\n\nvec4 taylorInvSqrt(vec4 r) {\treturn 1.79284291400159 - 0.85373472095314 * r;}\n\nfloat snoise(vec3 v) { \n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n  i = mod289(i); \n  vec4 p = permute( permute( permute( \n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvec3 snoiseVec3( vec3 x ){\n\n  float s  = snoise(vec3( x ));\n  float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n  float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n  vec3 c = vec3( s , s1 , s2 );\n  return c;\n\n}\n\nvec3 curlNoise( vec3 p ){\n  \n  const float e = .1;\n  vec3 dx = vec3( e   , 0.0 , 0.0 );\n  vec3 dy = vec3( 0.0 , e   , 0.0 );\n  vec3 dz = vec3( 0.0 , 0.0 , e   );\n\n  vec3 p_x0 = snoiseVec3( p - dx );\n  vec3 p_x1 = snoiseVec3( p + dx );\n  vec3 p_y0 = snoiseVec3( p - dy );\n  vec3 p_y1 = snoiseVec3( p + dy );\n  vec3 p_z0 = snoiseVec3( p - dz );\n  vec3 p_z1 = snoiseVec3( p + dz );\n\n  float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n  float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n  float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\n  const float divisor = 1.0 / ( 2.0 * e );\n  return normalize( vec3( x , y , z ) * divisor );\n\n}"},287:e=>{e.exports="\nprecision highp float;\nprecision mediump sampler2D;\n\nvarying vec2 vTextureCoord;        // grid coordinates\nuniform vec2 uTexelSize;\nuniform sampler2D textureVel; // vector field\n\nvec2 sampleVelocity(in vec2 uv) {\n    vec2 mult = vec2(1.0, 1.0);\n    if (uv.x < 0.0 || uv.x > 1.0) { mult.x = -1.0; }\n    if (uv.y < 0.0 || uv.y > 1.0) { mult.y = -1.0; }\n    return texture2D(textureVel, uv).xy;\n}\n\nvoid main() {\n  float L = sampleVelocity(vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n  float R = sampleVelocity(vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n  float T = sampleVelocity(vTextureCoord + vec2(0.0, uTexelSize.y)).y;\n  float B = sampleVelocity(vTextureCoord - vec2(0.0, uTexelSize.y)).y;\n  float div = 0.5 * (R - L + T - B);\n  gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n}"},546:e=>{e.exports="precision highp float;\n\nvarying vec2 vTextureCoord;\nuniform vec2 uTexelSize;\nuniform sampler2D texturePressure;\nuniform sampler2D textureVel;\n\nvoid main() {\n\tfloat pL     = texture2D(texturePressure, vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n\tfloat pR     = texture2D(texturePressure, vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n\tfloat pB     = texture2D(texturePressure, vTextureCoord - vec2(0.0, uTexelSize.y)).x;\n\tfloat pT     = texture2D(texturePressure, vTextureCoord + vec2(0.0, uTexelSize.y)).x;\n\tvec2 v       = texture2D(textureVel, vTextureCoord).xy;\n\tgl_FragColor = vec4(v - vec2(pR - pL, pT - pB), 0.0, 1.0);\n}"},639:e=>{e.exports="precision highp float;\nprecision mediump sampler2D;\n\nvarying vec2 vTextureCoord; // grid coordinates    \nuniform vec2 uTexelSize;\nuniform sampler2D texturePressure;\nuniform sampler2D textureDivergence;\n\nvoid main() {\n  // left, right, bottom, and top texturePressure samples\n  float L = texture2D(texturePressure, vTextureCoord - vec2(uTexelSize.x, 0.0)).x;\n  float R = texture2D(texturePressure, vTextureCoord + vec2(uTexelSize.x, 0.0)).x;\n  float B = texture2D(texturePressure, vTextureCoord - vec2(0.0, uTexelSize.y)).x;\n  float T = texture2D(texturePressure, vTextureCoord + vec2(0.0, uTexelSize.y)).x;\n\n  // textureDivergence sample, from center\n  float bC = texture2D(textureDivergence, vTextureCoord).x;\n  \n  // evaluate Jacobi iteration\n  gl_FragColor = vec4(0.25 * (L + R + B + T - bC), 0, 0, 1);\n}"},389:(e,t,n)=>{const o=n(125);e.exports=`\n// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nuniform vec2 uCenter;\nuniform vec2 uDir;\nuniform float uTime;\nuniform float uRadius;\nuniform float uStrength;\nuniform float uNoiseStrength;\nuniform float uIsVelocity;\n\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\n${o}\n\n#define PI 3.141592653\n\nvoid main(void) {\n\tvec2 center  = uCenter;\n\n\tfloat r = 0.15 + sin(cos(uTime) * 4.489538925) * 0.0;\n\tvec2 v       = vec2(r, 0.0);\n\tv            = rotate(v, uTime);\n\t\n\tvec3 noise = curlNoise(vec3(vTextureCoord * 2.0, uTime)) * uNoiseStrength;\n\n\tvec2 dir = uDir;\n\tdir *= uStrength;\n\tfloat d      = distance(vTextureCoord, center);\n\td            = smoothstep(uRadius, 0.0, d);\n\t\n\t\n\tvec3 color   = uIsVelocity > 0.5 ? vec3(dir, 0.0) : vec3(uStrength);\n\tif(uIsVelocity > .5) {\n\t\tcolor += noise * 0.5;\n\t} else {\n\t\tcolor += noise.rrr * uStrength;\n\t}\n\tcolor        *= d;\n\t\n\tvec3 base    = texture2D(texture, vTextureCoord).xyz;\n\t\n\tgl_FragColor = vec4(color + base, 1.0);\n}\n`},297:()=>{let e="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var t="oo"+Array(49).fill(0).map((t=>e[Math.random()*e.length|0])).join("");let n=t.slice(2),o=new RegExp(".{"+(t.length/4|0)+"}","g"),r=n.match(o).map((t=>{return(n=t).split("").reduce(((t,o,r)=>t+e.indexOf(o)*Math.pow(e.length,n.length-r-1)),0);var n}));window.fxhash=t,window.fxrand=((e,t,n,o)=>()=>{var r=((e|=0)+(t|=0)|0)+(o|=0)|0;return o=o+1|0,e=t^t>>>9,t=(n|=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+r|0,(r>>>0)/4294967296})(...r)},802:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o=[{bgColor:[192,158,121],color0:[108,185,253],color1:[221,14,153],color2:[26,25,24],normalBlend:!1},{bgColor:[228,211,200],color0:[23,22,185],color1:[233,139,29],color2:[20,91,141],normalBlend:!1},{bgColor:[233,230,230],color0:[183,165,149],color1:[33,30,29],color2:[169,15,15],normalBlend:!0}]},943:()=>{"use strict";String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},window.addEventListener("keydown",(e=>{if(83===e.keyCode&&(e.metaKey||e.ctrlKey)){e.preventDefault();const t=(()=>{const e=new Date;return`${e.getFullYear()}.${e.getMonth()+1}.${e.getDate()}-${e.getHours()}.${e.getMinutes()}.${e.getSeconds()}`})();((e,t)=>{var n=document.createElement("a"),o=(e=>{for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),r=o.length,i=new Uint8Array(r);r--;)i[r]=o.charCodeAt(r);return new Blob([i],{type:n})})(e.toDataURL({format:"png",multiplier:4})),r=URL.createObjectURL(o);n.download=`${t}.png`,n.href=r,n.click()})(document.querySelector("#main-canvas"),t)}}))},910:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});const o="a-f\\d",r=`#?[${o}]{3}[${o}]?`,i=`#?[${o}]{6}([${o}]{2})?`,s=new RegExp(`[^#${o}]`,"gi"),a=new RegExp(`^${r}$|^${i}$`,"i");var c=n(529),u=n.n(c),l=n(429),h=n.n(l);const f=class{constructor(e,t,n,o=!1){if("string"==typeof e){const{red:t,green:n,blue:o}=function(e,t={}){if("string"!=typeof e||s.test(e)||!a.test(e))throw new TypeError("Expected a valid hex string");let n=1;8===(e=e.replace(/^#/,"")).length&&(n=Number.parseInt(e.slice(6,8),16)/255,e=e.slice(0,6)),4===e.length&&(n=Number.parseInt(e.slice(3,4).repeat(2),16)/255,e=e.slice(0,3)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const o=Number.parseInt(e,16),r=o>>16,i=o>>8&255,c=255&o,u="number"==typeof t.alpha?t.alpha:n;return"array"===t.format?[r,i,c,u]:"css"===t.format?`rgb(${r} ${i} ${c}${1===u?"":` / ${Number((100*u).toFixed(2))}%`})`:{red:r,green:i,blue:c,alpha:u}}(e);this._r=t,this._g=n,this._b=o}else e.length?(this._r=e[0],this._g=e[1],this._b=e[2]):o?(this._hue=e,this._saturation=t,this.lightness=n):(this._r=e,this._g=t,this._b=n);this._updateHSL()}_updateRGB(){const e=h()(this._hue,this._saturation,this._lightness);this._r=e[0],this._g=e[1],this._b=e[2]}_updateHSL(){const e=u()(this._r,this._g,this._b);this._hue=e[0],this._saturation=parseFloat(e[1].split("%")[0])/100,this._lightness=parseFloat(e[2].split("%")[0])/100}set r(e){this._r=e,this._updateHSL()}get r(){return this._r}set g(e){this._g=e,this._updateHSL()}get g(){return this._g}set b(e){this._b=e,this._updateHSL()}get b(){return this._b}set hue(e){this._hue=e,this._updateRGB()}get hue(){return this._hue}set saturation(e){this._saturation=e,this._updateRGB()}get saturation(){return this._saturation}set lightness(e){this._lightness=e,this._updateRGB()}get lightness(){return this._lightness}get hex(){return 0}get value(){return[this._r,this._g,this._b]}set value(e){this._r=e[0],this._g=e[1],this.b=e[2]}get glsl(){return[this._r,this._g,this._b].map((e=>e/255))}}},619:(e,t,n)=>{"use strict";n.d(t,{uZ:()=>a,Gv:()=>s,gO:()=>p,H:()=>c,CD:()=>_,ei:()=>v,MX:()=>l,Iy:()=>h,B8:()=>f,m4:()=>x,Ak:()=>o,TV:()=>d,CW:()=>m,sg:()=>u});const o=(e,t="data",n=!0)=>{var o=n?JSON.stringify(e,null,4):JSON.stringify(e),i=r(o),s=new Blob([i],{type:"application/octet-stream"}),a=URL.createObjectURL(s),c=document.createElement("a");c.setAttribute("href",a),c.setAttribute("download",`${t}.json`);var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(u)},r=e=>{for(var t=[],n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return new Uint8Array(t)};var i=n(975);const s=e=>[e,.97*e,.94*e],a=(Math.PI,(e,t,n)=>Math.min(Math.max(e,t),n)),c=e=>{console.error(e)},u=e=>e/255,l=(e,t)=>void 0===e?fxrand():void 0===t?fxrand()*e:e+(t-e)*fxrand(),h=(e,t)=>Math.floor(l(e,t)),f=(e,t,n)=>e.length?f(e[0],e[1],e[2]):void 0===t?`rgb(${e}, ${e}, ${e})`:`rgb(${e}, ${t}, ${n})`,v=e=>e[h(e.length)],x=(e,t,n,o=1)=>{let r=t,i=n;return void 0===t&&(r=e),void 0===n&&(i=e),`rgb(${e}, ${r}, ${i}, ${o})`},d=e=>{for(let t=e.length-1;t>0;t--){const n=Math.floor(l()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},_=(e,t,n)=>e*(1-n)+t*n,m=(e,t,n)=>{var o=Math.max(0,Math.min(1,(n-e)/(t-e)));return o*o*(3-2*o)},p=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document;i.al(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1)},552:(e,t,n)=>{"use strict";n.d(t,{HX:()=>s,Tj:()=>r,hl:()=>i});var o=n(247);const r=(e,t,n)=>{const{margin:r}=o.Z,{innerWidth:i,innerHeight:s}=window;t=t||i,n=n||s;const a=i-r,c=s-r;let u=Math.min(t,a),l=Math.min(n,c);const h=a/t,f=c/n,v=Math.min(h,f);u=t*v,l=n*v;let x=Math.floor(i-u)/2,d=`\n  position:absolute;\n  width:${u}px;\n  height:${l}px;\n  top:${Math.floor(s-l)/2}px;\n  left:${x}px;\n  `;e.style.cssText=d},i=e=>{e.style.cssText="\n  position:absolute;\n  width:100%;\n  height:100%;\n  top:0;\n  left:0;\n  "},s=()=>{}},370:(e,t,n)=>{"use strict";n.d(t,{v:()=>o}),n(943),n(552);const o=(e,t,n={})=>{const o=document.createElement("canvas");o.width=e,o.height=t;const r=o.getContext("2d",n);return{canvas:o,ctx:r,width:e,height:t}}}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return n[e].call(i.exports,i,i.exports,r),i.exports}r.m=n,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+".bundle.js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="fxhash-boilerplate-webpack:",r.l=(n,o,i,s)=>{if(e[n])e[n].push(o);else{var a,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+i){a=h;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+i),a.src=n),e[n]=[o];var f=(t,o)=>{a.onerror=a.onload=null,clearTimeout(v);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(o))),t)return t(o)},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={179:0};r.f.j=(t,n)=>{var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,r)=>o=e[t]=[n,r]));n.push(o[2]=i);var s=r.p+r.u(t),a=new Error;r.l(s,(n=>{if(r.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,o[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,i,[s,a,c]=n,u=0;if(s.some((t=>0!==e[t]))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);c&&c(r)}for(t&&t(n);u<s.length;u++)i=s[u],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkfxhash_boilerplate_webpack=self.webpackChunkfxhash_boilerplate_webpack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";r(297);var e=r(723),t=r(619),n=r(247),o=r(160),i=r(685);function s(){var e=new i.WT(2);return i.WT!=Float32Array&&(e[0]=0,e[1]=0),e}function a(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function c(e,t){var n=t[0],o=t[1],r=n*n+o*o;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e}function u(e,t,n,o){var r=t[0],i=t[1];return e[0]=r+o*(n[0]-r),e[1]=i+o*(n[1]-i),e}function l(e,t,n,o){var r=t[0]-n[0],i=t[1]-n[1],s=Math.sin(o),a=Math.cos(o);return e[0]=r*a-i*s+n[0],e[1]=r*s+i*a+n[1],e}var h=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e};s();const f=2160,v=3840;var x=r(552),d=r(910),_=r(187),m=r.n(_),p=r(370);const E=640,T=[0,9,10],g="poseFound",y="poseLost";class R extends(m()){constructor(){super();const{canvas:e,ctx:t,width:n,height:o}=(0,p.v)(E,480);this.canvas=e,this.ctx=t,document.body.appendChild(e),e.className="webcam-debug",e.style.cssText=`\n      position: absolute;\n      right: 0;\n      bottom: 0;\n      width:${n/2}px;\n      height:${o/2}px;\n      z-index: 999;\n      display: none;\n    `,this.init()}async init(){await this._setupCamera(),this.detector=await poseDetection.createDetector(poseDetection.SupportedModels.MoveNet),this.checkPose()}_setupCamera(){return new Promise(((e,t)=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||t(new Error("no camera"));const n=document.getElementById("video");n.width=E,n.height=480;const o=t=>{this.video=n,n.addEventListener("loadeddata",(()=>{e(n)})),n.srcObject=t,n.play(),console.log("Stream fetched :",n.width,n.height,n.videoWidth,n.videoHeight)};let r="";navigator.mediaDevices.enumerateDevices().then((function(e){const t=e.filter((e=>"videoinput"===e.kind));if(console.log("webcams",t.length),console.table(t),1===t.length)r=t[0].deviceId;else{const e=t.filter((e=>e.label.indexOf("C920")>-1))[0];r=e?e.deviceId:t[0].deviceId}window.navigator.mediaDevices.getUserMedia({video:{width:640,height:480,frameRate:30,deviceId:r}}).then(o).catch((function(){console.error("No camera available.")}))})).catch((function(e){console.log(e.name+": "+e.message)}))}))}async checkPose(){const e=await this.detector.estimatePoses(this.video);if(e.length>0){const t=T.map((t=>{const{x:n,y:o,score:r}=e[0].keypoints[t];return{pos:[(E-n)/E,1-o/480],score:r}}));this.emit(g,t),this.debugPose(e[0])}else this.emit(y);requestAnimationFrame((()=>this.checkPose()))}debugPose({keypoints:e}){const{ctx:n,canvas:o}=this,{width:r,height:i}=o;n.clearRect(0,0,r,i),n.fillStyle=(0,t.m4)(0,0,0,.25),e.forEach((({x:e,y:o,score:i},s)=>{i>.5&&(n.fillStyle=T.indexOf(s)>-1?(0,t.B8)(255,128,0):(0,t.B8)(220),((e,t,o=5)=>{n.beginPath(),n.arc(e,t,o,0,2*Math.PI),n.fill()})(r-e,o,T.indexOf(s)>-1?5:2))}))}}var A=r(51),C=r(333),S=r.n(C),b=r(287),M=r.n(b),L=r(110),w=r.n(L),I=r(639),N=r.n(I),P=r(546),F=r.n(P),z=r(389),D=r.n(z),U=r(841),O=r.n(U);const B=r(447),G=(e,t)=>{if(2===e.length){const n=s();return u(n,e[0],e[1],t),n}const n=[];for(let o=0;o<e.length-1;o++){const r=s();u(r,e[o],e[o+1],t),n.push(r)}return G(n,t)};let X=null,V=null,k=null;const H=.5*(Math.sqrt(3)-1),W=(3-Math.sqrt(3))/6,j=1/6,Y=(Math.sqrt(5)-1)/4,Z=(5-Math.sqrt(5))/20,K=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),q=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);console.log(window.fxhash);let $=new class{constructor(e=Math.random){const t="function"==typeof e?e:function(e){let t=0,n=0,o=0,r=1;const i=function(){let e=4022871197;return function(t){t=t.toString();for(let n=0;n<t.length;n++){e+=t.charCodeAt(n);let o=.02519603282416938*e;e=o>>>0,o-=e,o*=e,e=o>>>0,o-=e,e+=4294967296*o}return 2.3283064365386963e-10*(e>>>0)}}();return t=i(" "),n=i(" "),o=i(" "),t-=i(e),t<0&&(t+=1),n-=i(e),n<0&&(n+=1),o-=i(e),o<0&&(o+=1),function(){const e=2091639*t+2.3283064365386963e-10*r;return t=n,n=o,o=e-(r=0|e)}}(e);this.p=function(e){const t=new Uint8Array(256);for(let e=0;e<256;e++)t[e]=e;for(let n=0;n<255;n++){const o=n+~~(e()*(256-n)),r=t[n];t[n]=t[o],t[o]=r}return t}(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let e=0;e<512;e++)this.perm[e]=this.p[255&e],this.permMod12[e]=this.perm[e]%12}noise2D(e,t){const n=this.permMod12,o=this.perm;let r=0,i=0,s=0;const a=(e+t)*H,c=Math.floor(e+a),u=Math.floor(t+a),l=(c+u)*W,h=e-(c-l),f=t-(u-l);let v,x;h>f?(v=1,x=0):(v=0,x=1);const d=h-v+W,_=f-x+W,m=h-1+2*W,p=f-1+2*W,E=255&c,T=255&u;let g=.5-h*h-f*f;if(g>=0){const e=3*n[E+o[T]];g*=g,r=g*g*(K[e]*h+K[e+1]*f)}let y=.5-d*d-_*_;if(y>=0){const e=3*n[E+v+o[T+x]];y*=y,i=y*y*(K[e]*d+K[e+1]*_)}let R=.5-m*m-p*p;if(R>=0){const e=3*n[E+1+o[T+1]];R*=R,s=R*R*(K[e]*m+K[e+1]*p)}return 70*(r+i+s)}noise3D(e,t,n){const o=this.permMod12,r=this.perm;let i,s,a,c;const u=.3333333333333333*(e+t+n),l=Math.floor(e+u),h=Math.floor(t+u),f=Math.floor(n+u),v=(l+h+f)*j,x=e-(l-v),d=t-(h-v),_=n-(f-v);let m,p,E,T,g,y;x>=d?d>=_?(m=1,p=0,E=0,T=1,g=1,y=0):x>=_?(m=1,p=0,E=0,T=1,g=0,y=1):(m=0,p=0,E=1,T=1,g=0,y=1):d<_?(m=0,p=0,E=1,T=0,g=1,y=1):x<_?(m=0,p=1,E=0,T=0,g=1,y=1):(m=0,p=1,E=0,T=1,g=1,y=0);const R=x-m+j,A=d-p+j,C=_-E+j,S=x-T+2*j,b=d-g+2*j,M=_-y+2*j,L=x-1+.5,w=d-1+.5,I=_-1+.5,N=255&l,P=255&h,F=255&f;let z=.6-x*x-d*d-_*_;if(z<0)i=0;else{const e=3*o[N+r[P+r[F]]];z*=z,i=z*z*(K[e]*x+K[e+1]*d+K[e+2]*_)}let D=.6-R*R-A*A-C*C;if(D<0)s=0;else{const e=3*o[N+m+r[P+p+r[F+E]]];D*=D,s=D*D*(K[e]*R+K[e+1]*A+K[e+2]*C)}let U=.6-S*S-b*b-M*M;if(U<0)a=0;else{const e=3*o[N+T+r[P+g+r[F+y]]];U*=U,a=U*U*(K[e]*S+K[e+1]*b+K[e+2]*M)}let O=.6-L*L-w*w-I*I;if(O<0)c=0;else{const e=3*o[N+1+r[P+1+r[F+1]]];O*=O,c=O*O*(K[e]*L+K[e+1]*w+K[e+2]*I)}return 32*(i+s+a+c)}noise4D(e,t,n,o){const r=this.perm;let i,s,a,c,u;const l=(e+t+n+o)*Y,h=Math.floor(e+l),f=Math.floor(t+l),v=Math.floor(n+l),x=Math.floor(o+l),d=(h+f+v+x)*Z,_=e-(h-d),m=t-(f-d),p=n-(v-d),E=o-(x-d);let T=0,g=0,y=0,R=0;_>m?T++:g++,_>p?T++:y++,_>E?T++:R++,m>p?g++:y++,m>E?g++:R++,p>E?y++:R++;const A=T>=3?1:0,C=g>=3?1:0,S=y>=3?1:0,b=R>=3?1:0,M=T>=2?1:0,L=g>=2?1:0,w=y>=2?1:0,I=R>=2?1:0,N=T>=1?1:0,P=g>=1?1:0,F=y>=1?1:0,z=R>=1?1:0,D=_-A+Z,U=m-C+Z,O=p-S+Z,B=E-b+Z,G=_-M+2*Z,X=m-L+2*Z,V=p-w+2*Z,k=E-I+2*Z,H=_-N+3*Z,W=m-P+3*Z,j=p-F+3*Z,K=E-z+3*Z,$=_-1+4*Z,J=m-1+4*Z,Q=p-1+4*Z,ee=E-1+4*Z,te=255&h,ne=255&f,oe=255&v,re=255&x;let ie=.6-_*_-m*m-p*p-E*E;if(ie<0)i=0;else{const e=r[te+r[ne+r[oe+r[re]]]]%32*4;ie*=ie,i=ie*ie*(q[e]*_+q[e+1]*m+q[e+2]*p+q[e+3]*E)}let se=.6-D*D-U*U-O*O-B*B;if(se<0)s=0;else{const e=r[te+A+r[ne+C+r[oe+S+r[re+b]]]]%32*4;se*=se,s=se*se*(q[e]*D+q[e+1]*U+q[e+2]*O+q[e+3]*B)}let ae=.6-G*G-X*X-V*V-k*k;if(ae<0)a=0;else{const e=r[te+M+r[ne+L+r[oe+w+r[re+I]]]]%32*4;ae*=ae,a=ae*ae*(q[e]*G+q[e+1]*X+q[e+2]*V+q[e+3]*k)}let ce=.6-H*H-W*W-j*j-K*K;if(ce<0)c=0;else{const e=r[te+N+r[ne+P+r[oe+F+r[re+z]]]]%32*4;ce*=ce,c=ce*ce*(q[e]*H+q[e+1]*W+q[e+2]*j+q[e+3]*K)}let ue=.6-$*$-J*J-Q*Q-ee*ee;if(ue<0)u=0;else{const e=r[te+1+r[ne+1+r[oe+1+r[re+1]]]]%32*4;ue*=ue,u=ue*ue*(q[e]*$+q[e+1]*J+q[e+2]*Q+q[e+3]*ee)}return 27*(i+s+a+c+u)}}(window.fxhash);const J=(e,t,n,o)=>void 0===n?$.noise2D(e,t):void 0===o?$.noise3D(e,t,n):$.noise4D(e,t,n,o),Q=(e,t,n=1)=>J(e*n,t*n),ee=(e,t,n,o=1)=>J(e*o,t*o,n*o),te=(e,t,n=1,o=5)=>{let r=0,i=0;for(let s=0;s<o;s++)i=Math.pow(2,s),r+=Q(e*n*i,t*n*i)/i;return r},ne=(e,t,n,o=1,r=5,i=2)=>{let s=0,a=0;for(let c=0;c<r;c++)a=Math.pow(i,c),s+=ee(e,t,n,o*a)/a;return s};let oe,re,ie,se,ae,ce,ue,le,he,fe=0,ve=.5,xe=1,de=!1;const _e=e=>.5*Q(e,le,xe)+.5;let me,pe,Ee,Te;class ge extends e.hG{constructor({matrix:r},i=1,s=[]){super(),void 0===me&&(me=(0,t.ei)([.95,1]),pe=(0,t.MX)()<.25);const a=.25*i,c=e.v6.plane(a,a,1),u=[],l=[],h=[0,0,0];let f=pe?0:.14;const v=1-2*f;f*=e.GL.aspectRatio;const x=1-2*f,d=e=>{let t=!0;return o.fF(h,e,r),(h[0]<-v||h[0]>v||h[1]<-x||h[1]>x)&&(t=!1),t};for(let e=-8;e<=8;e+=a)for(let n=-8;n<=8;n+=a){const o=d([n,e,0]);u.push([n,e,o?0:1]),l.push([(0,t.MX)(),.1*(0,t.MX)(-1,1),(0,t.MX)()])}this.extras=l,c.bufferInstance(u,"aPosOffset").bufferInstance(0===s.length?l:s,"aExtra"),this.setMesh(c).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aPosOffset;\nin vec3 aExtra;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform vec2 uOffset;\nuniform float uCharScale;\nuniform float uAnimate;\n\nuniform sampler2D uMap;\nuniform sampler2D uMaskMap;\n\nout vec2 vTextureCoord;\nout vec3 vExtra;\nout vec3 vColor;\nout float vGrey;\nout float vSkip;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\n#define PI 3.1415926535897932384626433832795\n\nvoid main(void) {\n    vec3 pos = aVertexPosition * uCharScale;\n    pos.xy += (aExtra.xz - .5) * 0.02;\n    // float theta = (floor(aExtra.z * 3.0) - 1.0) * PI * 0.5;\n    // pos.xy = rotate(pos.xy, theta);\n\n    pos.xy += aPosOffset.xy + uOffset;\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n\n    vec4 screenPos = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aPosOffset.xy, 0.0, 1.0);\n    vec2 uv = screenPos.xy / screenPos.w * .5 + .5;\n\n    float mask = 1.0 - texture(uMaskMap, uv).r;\n    float grey = texture(uMap, uv).r;\n    vGrey = mix(grey, mask, uAnimate);\n    // vGrey = grey + mask * uAnimate * 0.1;\n    vTextureCoord = aTextureCoord;\n    vExtra = aExtra;\n    vSkip = aPosOffset.z;\n    vColor = vec3(mask);\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nin vec3 vExtra;\nin vec3 vColor;\nin float vGrey;\nin float vSkip;\n\nuniform float uNumChars;\nuniform float uSkipThreshold;\nuniform sampler2D uCharMap;\nuniform vec3 uColor;\n\nuniform float uThresholdInvert;\nuniform float uPresent;\n\nout vec4 oColor;\n\nvoid main(void) {\n    if(vSkip > .5 && uPresent < .5) discard;\n    float n = fract(vExtra.x + vExtra.z);\n    if(n < uSkipThreshold) discard;\n\n    float total = uNumChars * uNumChars;\n    // float g = clamp(vGrey + vExtra.y * step(1.0/total, vGrey), 0.0, 0.99);\n    float g = clamp(vGrey, 0.0, 0.99);\n\n    bool inverted = vExtra.z < uThresholdInvert && g > 2.0 / total;\n\n    if(inverted) {\n        g = 1.0 - g + 1.0/total;\n    }\n\n    float index = floor(g * total);\n    float u = mod(index, uNumChars) / uNumChars;\n    float v = floor(index / uNumChars) / uNumChars;\n    vec2 uvChar = vec2(u, v) + vTextureCoord / uNumChars;\n    vec4 charColor = texture(uCharMap, uvChar);\n    charColor.rgb = uColor;\n    if(inverted) {\n        charColor.a = 1.0 - charColor.a;\n    }\n\n    oColor = charColor;\n    // oColor = vec4(vec3(vGrey), 1.0);\n    // oColor = vec4(vColor, 1.0);\n}").uniform("uNumChars",n.Z.numLevel).uniform("uThresholdInvert",.05).uniform("uCharScale",me)}}class ye extends e.hG{constructor(n){super();const o=.25*n,r=.25,i=e.v6.plane(.02,10,1),s=[];for(let e=-8;e<=8;e+=o){const n=[e-o/2,(0,t.MX)(.75,1),(0,t.MX)()];s.push(n)}i.bufferInstance(s,"aPosOffset"),this.setMesh(i).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aPosOffset;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nout vec2 vTextureCoord;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\nvoid main(void) {\n    vec3 pos = aVertexPosition;\n    pos.x *= aPosOffset.y;\n    pos.x += aPosOffset.x;\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n    vTextureCoord = aTextureCoord;\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform vec3 uColor;\n\nout vec4 oColor;\n\nvoid main(void) {\n    oColor = vec4(uColor, 1.0);\n}").uniform("uColor",[r,r,r])}}class Re extends e.hG{constructor(){super().setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform vec3 uColor;\nuniform float uRatio;\nuniform float uSeed;\nuniform float uFrameSize;\n\nout vec4 oColor;\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvoid main(void) {\n    float m = 0.05 * uFrameSize;\n\n    vec2 uv = vTextureCoord;\n    uv.y /= uRatio;\n    float n = fbm(vec3(uv, uSeed) * 200.0);\n    float nBase = snoise(vec3(uSeed, uv) * 5.0);\n    m *= 1.0 + (n * 0.5 + nBase) * 0.05;\n    \n\n    uv = abs(vTextureCoord - 0.5);\n    float t = 0.005;\n    float dx = smoothstep(0.5 - m, 0.5 - m + t, uv.x);\n    m *= uRatio;\n    float dy = smoothstep(0.5 - m, 0.5 - m + t, uv.y);\n    float a = max(dx, dy);\n    if(a < .5) discard;\n    oColor = vec4(uColor, 1.);\n}").uniform("uRatio",e.GL.aspectRatio).uniform("uFrameSize",1).uniform("uColor",[1,1,1])}}class Ae extends e.hG{constructor(){super();const n=[],o=[],r=[],i=2.5/e.GL.aspectRatio,s=(0,t.MX)(i),a=(0,t.Iy)(100,300);for(;n.length<a;){let e=(0,t.MX)(-2.5,2.5),a=(0,t.MX)(-i,i);if(ne(e,a,s,1,5)+(0,t.MX)(-.2,.2)>.2){let o=(0,t.MX)(5,40);(0,t.MX)()<.05&&(o=(0,t.MX)(60,80)),n.push([e,a,o])}o.push([(0,t.MX)(),(0,t.MX)()]),r.push(n.length-1)}const c=new e.Kj(e.GL.POINTS).bufferVertex(n).bufferTexCoord(o).bufferIndex(r);this.setMesh(c).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nout vec2 vTextureCoord;\nout vec3 vNormal;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n\n    gl_PointSize = aVertexPosition.z;\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform vec3 uColors[3];\nout vec4 oColor;\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvoid main(void) {\n    vec2 uv = gl_PointCoord - 0.5;\n    float n = fbm(vec3(uv, vTextureCoord.x) * mix(5.0, 10.0, vTextureCoord.y));\n    float d = length(uv);\n    d = step(d, 0.5 - n * 0.25);\n    if(d <= 0.0) discard;\n\n    float p = fract(vTextureCoord.x + vTextureCoord.y) * 3.0;\n    int i = int(p * 2.0);\n    vec3 uColor = uColors[i];\n\n    oColor = vec4( uColor, 1.0);\n}")}}class Ce{constructor(o,r=[0,0],i=1,s=!1,a=[]){this.color=[0,0,0],this.offset=r,this._isBlurred=s,this._blurAmount=(0,t.MX)(1,3)/i;const{numLevel:c}=n.Z;this._fbo=new e.SY(e.GL.width,e.GL.height),this._draw=new ge(o,i,a),this._draw.setClearColor(0,0,0,0).uniform("uColor",this.color).uniform("uOffset",r).uniform("uNumChars",c).uniform("uSkipThreshold",this._isBlurred?-.1:0),Te||(Te=e.v6.bigTriangle()),this._textureScratch=function(){Ee||(Ee=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform float uSeed;\nuniform float uRatio;\nuniform float uThreshold;\nout vec4 oColor;\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvoid main(void) {\n    vec2 uv = vTextureCoord;\n    uv.y /= uRatio;\n    float noiseScale = 0.5;\n    float n0 = fbm(vec3(uv, uSeed) * 200.0 * noiseScale);\n    float n1 = fbm(vec3(uSeed, uv) * 800.0 * noiseScale);\n\n    float n = n0 + (n1 - 0.5) * 0.25;\n\n    oColor = vec4(n, n, n, 1.0);\n}").setClearColor(0,0,0,0));const n=new e.uL(1024,1024);return Ee.bindFrameBuffer(n).uniform("uSeed",(0,t.MX)(10)).uniform("uRatio",e.GL.width/e.GL.height).draw(),n.texture}(),this._drawBlur=(new e.hG).setMesh(Te).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform vec2 uResolution;\nuniform vec2 uDirection;\nuniform vec3 uColor;\n\nout vec4 oColor;\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n\tvec4 color = vec4(0.0);\n\tvec2 off1 = vec2(1.3846153846) * direction;\n\tvec2 off2 = vec2(3.2307692308) * direction;\n\tcolor += texture(image, uv) * 0.2270270270;\n\tcolor += texture(image, uv + (off1 / resolution)) * 0.3162162162;\n\tcolor += texture(image, uv - (off1 / resolution)) * 0.3162162162;\n\tcolor += texture(image, uv + (off2 / resolution)) * 0.0702702703;\n\tcolor += texture(image, uv - (off2 / resolution)) * 0.0702702703;\n\treturn color;\n}\n\nvoid main(void) {\n    oColor = blur9(uMap, vTextureCoord, uResolution, uDirection);\n\t\toColor.rgb = uColor;\n}").setClearColor(0,0,0,0).uniform("uColor",this.color);const u=this._isBlurred?(0,t.MX)(.8,.9):1;this._isBlurred,this._drawThreshold=(new e.hG).setMesh(Te).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform float uThreshold;\n\nout vec4 oColor;\n\nvoid main(void) {\n    vec4 color = texture(uMap, vTextureCoord);\n    color.a = step(0.18, color.a);\n    oColor = color;\n}").setClearColor(0,0,0,0).uniform("uThreshold",u),this._drawScratch=(new e.hG).setMesh(Te).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform sampler2D uScratchMap;\nuniform sampler2D uMountainMap;\nuniform sampler2D uMaskMap;\nuniform float uThreshold;\nuniform float uPresent;\nuniform float uAnimate;\nout vec4 oColor;\n\nvoid main(void) {\n    float n = texture(uScratchMap, vTextureCoord).r;\n    float t = n;\n    n = smoothstep(uThreshold, uThreshold + 0.01, n);\n\n    vec4 color = texture(uMap, vTextureCoord);\n    color.rgb *= mix(1.0, .7, t);\n    color.a *= n;\n\n    float mask = texture(uMaskMap, vTextureCoord).r;\n    mask = smoothstep(0.0, .25, mask);\n    mask = mix(1.0, mask, uAnimate);\n    float m = texture(uMountainMap, vTextureCoord).r * (1.0 - uPresent) * mask;\n    color.a *= 1.0 - m;\n\n    oColor = color;\n}").setClearColor(0,0,0,0).uniform("uThreshold",this._isBlurred?.2:.25)}applyBlur(e){const{width:t,height:n}=this._fbo.read,o=e?2:1,r=.75*this._blurAmount*o;for(let e=0;e<3;e++){const o=1/Math.pow(2,e)*r;this._drawBlur.bindFrameBuffer(this._fbo.write).bindTexture("uMap",this._fbo.read.texture,0).uniform("uResolution",[t*o,n*o]).uniform("uDirection",[1,0]).draw(),this._fbo.swap(),this._drawBlur.bindFrameBuffer(this._fbo.write).bindTexture("uMap",this._fbo.read.texture,0).uniform("uResolution",[t*o,n*o]).uniform("uDirection",[0,1]).draw(),this._fbo.swap()}this._drawThreshold.bindFrameBuffer(this._fbo.write).bindTexture("uMap",this._fbo.read.texture,0).uniform("uThreshold",.0015).draw(),this._fbo.swap()}applyScratch(e,t,n,o){this._drawScratch.bindFrameBuffer(this._fbo.write).bindTexture("uMap",this._fbo.read.texture,0).bindTexture("uScratchMap",this._textureScratch,1).bindTexture("uMountainMap",e,2).bindTexture("uMaskMap",t,3).uniform("uPresent",n?1:0).uniform("uAnimate",o?1:0).draw(),this._fbo.swap()}render(e,t,n,o,r,i,s){void 0!==r&&(this._draw.uniform("uColor",r),this._drawBlur.uniform("uColor",r)),this._draw.bindFrameBuffer(this._fbo.read).bindTexture("uMap",e,0).bindTexture("uCharMap",t,1).bindTexture("uMaskMap",o,2).uniform("uPresent",i?1:0).uniform("uAnimate",s?1:0).draw(),this._isBlurred&&this.applyBlur(i),this.applyScratch(n,o,i,s)}get texture(){return this._fbo.read.texture}get extras(){return this._draw.extras}resize(){this._fbo=new e.SY(e.GL.width,e.GL.height)}}function Se(){const{numLevel:o}=n.Z,r=1024,i=document.createElement("canvas"),s=i.getContext("2d",{willReadFrequently:!0});i.width=r,i.height=r,s.textAlign="left",s.textBaseline="top",s.fillStyle="white";const a=r/o;s.font=`${a}px Noto Serif TC`;let c=(()=>{const{numLevel:e}=n.Z,o=(()=>{const e=document.body.querySelector(".hidden").innerHTML,n=[];for(let t=0;t<e.length;t++){const o=e[t],r=e.charCodeAt(t);r>12310&&r<5e4&&-1===n.indexOf(o)&&n.push(o)}return(0,t.TV)(n)})(),{canvas:r,ctx:i}=(0,p.v)(64,64,{willReadFrequently:!0});r.style.cssText="\n    position: absolute;\n    z-index: 999;\n    top:0;\n    left:0;\n    ",i.fillStyle="white";let s=o.map((e=>{i.clearRect(0,0,r.width,r.height),i.font="64px Noto Serif TC",i.textAlign="left",i.textBaseline="top",i.fillText(e,0,0);const t=i.getImageData(0,0,r.width,r.height).data;let n=0;for(let e=0;e<t.length;e+=4)0!==t[e+3]&&n++;return{char:e,count:n}}));s.sort(((e,t)=>e.count-t.count));let a=(0,t.Iy)(8);for(;a--;)s.shift();return function(e,n){if(e.sort(((e,t)=>e.count-t.count)),n>=e.length)return e;if(n<=0)return[];const o=Math.floor(e.length/n),r=Math.max(1,Math.floor(o/4)),i=new Set;for(;i.size<n;)for(let s=0;s<n&&i.size<n;s++){let n=s*o+Math.floor((0,t.MX)()*r)-Math.floor(r/2);n=Math.max(0,Math.min(n,e.length-1)),i.add(e[n])}return Array.from(i)}(s,e*e-1).map((({char:e})=>e))})();c.length=o*o;for(let e=0;e<o;e++)for(let t=0;t<o;t++){const n=t+e*o,i=c[n-1];n>0&&s.fillText(i,t*a,r-e*a-a)}return new e.fy(i)}class be extends e.hG{constructor(){super();const n=e.v6.plane(30,1,1);let o=4e5;const r=[],i=[];for(;o--;)r.push([(0,t.MX)(),(0,t.MX)(),(0,t.MX)()]),i.push([(0,t.MX)(),(0,t.MX)(),(0,t.MX)()]);n.bufferInstance(r,"aPosOffset").bufferInstance(i,"aExtra"),this.setMesh(n).useProgram("// basic.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec3 aPosOffset;\nattribute vec3 aExtra;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec3 uPoint0;\nuniform vec3 uPoint1;\nuniform vec3 uPoint2;\nuniform vec3 uPoint3;\nuniform vec3 uSeeds;\nuniform float uWetness;\nuniform float uNoiseScale;\nuniform float uLineWidthScale;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vColor;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\nvec3 bezier(vec3 A, vec3 B, vec3 C, vec3 D, float t) {\n  vec3 E = mix(A, B, t);\n  vec3 F = mix(B, C, t);\n  vec3 G = mix(C, D, t);\n\n  vec3 H = mix(E, F, t);\n  vec3 I = mix(F, G, t);\n\n  vec3 P = mix(H, I, t);\n\n  return P;\n}\n\nvec3 bezier(vec3 A, vec3 B, vec3 C, vec3 D, vec3 E, float t) {\n  vec3 A1 = mix(A, B, t);\n  vec3 B1 = mix(B, C, t);\n  vec3 C1 = mix(C, D, t);\n  vec3 D1 = mix(D, E, t);\n\n  vec3 A2 = mix(A1, B1, t);\n  vec3 B2 = mix(B1, C1, t);\n  vec3 C2 = mix(C1, D1, t);\n\n  vec3 A3 = mix(A2, B2, t);\n  vec3 B3 = mix(B2, C2, t);\n  \n  vec3 P = mix(A3, B3, t);\n\n  return P;\n}\n\nvec3 bezier(vec3 A, vec3 B, vec3 C, vec3 D, vec3 E, vec3 F, float t) {\n  vec3 A1 = mix(A, B, t);\n  vec3 B1 = mix(B, C, t);\n  vec3 C1 = mix(C, D, t);\n  vec3 D1 = mix(D, E, t);\n  vec3 E1 = mix(E, F, t);\n\n  vec3 A2 = mix(A1, B1, t);\n  vec3 B2 = mix(B1, C1, t);\n  vec3 C2 = mix(C1, D1, t);\n  vec3 D2 = mix(D1, E1, t);\n\n  vec3 A3 = mix(A2, B2, t);\n  vec3 B3 = mix(B2, C2, t);\n  vec3 C3 = mix(C2, D2, t);\n\n  vec3 A4 = mix(A3, B3, t);\n  vec3 B4 = mix(B3, C3, t);\n  \n  vec3 P = mix(A4, B4, t);\n\n  return P;\n}\n\nvec3 bezier(vec3 A, vec3 B, vec3 C, vec3 D, vec3 E, vec3 F, vec3 G, float t) {\n  vec3 A1 = mix(A, B, t);\n  vec3 B1 = mix(B, C, t);\n  vec3 C1 = mix(C, D, t);\n  vec3 D1 = mix(D, E, t);\n  vec3 E1 = mix(E, F, t);\n  vec3 F1 = mix(F, G, t);\n\n  vec3 A2 = mix(A1, B1, t);\n  vec3 B2 = mix(B1, C1, t);\n  vec3 C2 = mix(C1, D1, t);\n  vec3 D2 = mix(D1, E1, t);\n  vec3 E2 = mix(E1, F1, t);\n\n  vec3 A3 = mix(A2, B2, t);\n  vec3 B3 = mix(B2, C2, t);\n  vec3 C3 = mix(C2, D2, t);\n  vec3 D3 = mix(D2, E2, t);\n\n  vec3 A4 = mix(A3, B3, t);\n  vec3 B4 = mix(B3, C3, t);\n  vec3 C4 = mix(C3, D3, t);\n\n  vec3 A5 = mix(A4, B4, t);\n  vec3 B5 = mix(B4, C4, t);\n  \n  vec3 P = mix(A5, B5, t);\n\n  return P;\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nfloat getMappedOffset(float offset) {\n    float t = 0.1;\n    float mapPos = mix(-t, 1.0 + t, offset);\n    return mapPos;\n}\n\nvoid main(void) {\n    float t;\n    vec3 pos = aVertexPosition;\n    pos.y *= mix(1.0, 3.0, aExtra.y);\n\n    vec3 curr = bezier(uPoint0, uPoint1, uPoint2, uPoint3, getMappedOffset(aPosOffset.x));\n    vec3 next = bezier(uPoint0, uPoint1, uPoint2, uPoint3, getMappedOffset(aPosOffset.x + 0.01));\n\n    // stroke scale\n    float nScale = fbm(vec3(aPosOffset.x, aPosOffset.y * 3.0, uSeeds.x) * 2.0 * uNoiseScale);\n    t = uWetness + mix(-1.0, 1.0, aExtra.x) * 0.05;\n    nScale = smoothstep(t, t + 0.05, nScale);\n\n    // stroke fade\n    const float fadeEnd = 0.05;\n    float strokeFade = abs(aPosOffset.x - 0.5);\n\n    float nFade = fbm(vec3(aPosOffset.yy, uSeeds.y) * 2.0);\n    t = 0.2;\n    nFade = smoothstep(t, 1.0-t, nFade);\n\n    t = mix(0.1, 0.3, nFade);\n    strokeFade = smoothstep(0.5 - t, 0.5 - fadeEnd, strokeFade);\n    nScale -= strokeFade;\n\n    nScale = max(nScale, 0.0);\n    pos *= nScale;\n\n    // line width\n    float lineWidth = 400.0;\n    float nLineWidth = fbm(vec3(aPosOffset.x, aPosOffset.y, uSeeds.y) * 0.5);\n    nLineWidth = smoothstep(0.3, 0.7, nLineWidth);\n    t = 0.2;\n    lineWidth *= mix(1.0 - t, 1.0 + t, nLineWidth) * uLineWidthScale;\n\n    pos.y += mix(-lineWidth, lineWidth, aPosOffset.y) * 0.5;\n\n    vec2 dir = normalize(next.xy - curr.xy);\n    float theta = atan(dir.y, dir.x);\n    pos.xy = rotate(pos.xy, theta);\n\n    pos += curr;\n\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    // color\n    float nColor = fbm(vec3(aPosOffset.x, aPosOffset.y * 50.0, uSeeds.z) * 3.0);\n    nColor = smoothstep(0.3, 0.7, nColor);\n    float g = mix(0.1, 1.0, nColor);\n    g = nColor * 0.25;\n\n    vColor = vec3(g);\n    // vColor = vec3(nFade);\n    // vColor = vec3(nLineWidth);\n}","// copy.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec3 vColor;\n\nvoid main(void) {\n    gl_FragColor = vec4(vColor, 0.5);\n    // gl_FragColor = vec4(vColor, 1.0);\n}")}}let Me,Le;let we,Ie=0;class Ne extends e.SY{constructor(n,o=[0,-1],r=1,i=!1){const{width:s,height:a}=n;super(s,a);const c=i;for(this.isFinished=!1,we||(we=new e.Cg),Ie++,this._texturePattern=n,this._textureNoise=(n=>{if(!Le){const n=t.gO?e.GL.HALF_FLOAT:e.GL.FLOAT,o=2048;Le=new e.uL(o,o,{type:n}),Me=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nin vec2 vTextureCoord;\nuniform float uNoiseScale;\nuniform float uSeed;\n\nout vec4 oColor;\n\n// curlNoise.glsl\n\nvec3 mod289_0(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\n\nvec4 mod289_0(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0;  }\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\nvec3 snoiseVec3( vec3 x ){\n\n\tfloat s  = snoise(vec3( x ));\n\tfloat s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n\tfloat s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n\tvec3 c = vec3( s , s1 , s2 );\n\treturn c;\n\n}\n\nvec3 curlNoise( vec3 p ){\n\t\n\tconst float e = .1;\n\tvec3 dx = vec3( e   , 0.0 , 0.0 );\n\tvec3 dy = vec3( 0.0 , e   , 0.0 );\n\tvec3 dz = vec3( 0.0 , 0.0 , e   );\n\n\tvec3 p_x0 = snoiseVec3( p - dx );\n\tvec3 p_x1 = snoiseVec3( p + dx );\n\tvec3 p_y0 = snoiseVec3( p - dy );\n\tvec3 p_y1 = snoiseVec3( p + dy );\n\tvec3 p_z0 = snoiseVec3( p - dz );\n\tvec3 p_z1 = snoiseVec3( p + dz );\n\n\tfloat x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n\tfloat y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n\tfloat z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n\n\tconst float divisor = 1.0 / ( 2.0 * e );\n\treturn normalize( vec3( x , y , z ) * divisor );\n\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289_1(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289_1(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289_1(((x * 34.0) + 1.0) * x);}\n\nfloat noise_0(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise_0(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvoid main(void) {\n    float s = 3.5 * uNoiseScale;\n    // alt version\n    s = 5.5;\n    float n = fbm(vec3(vTextureCoord, uSeed) * s * 10.0) - 0.5;\n    float n1 = fbm(vec3(vTextureCoord, uSeed) * s * 40.0) - 0.5;\n    n += n1 * 0.5;\n    n = clamp(n, -1.0, 1.0);\n    vec3 noise = curlNoise(vec3(vTextureCoord, uSeed) * s);\n    noise.z = n * 20.0;\n    \n    oColor = vec4(noise, 1.0);\n}").setClearColor(0,0,0,1).bindFrameBuffer(Le)}return Me.uniform("uSeed",(0,t.MX)(1)).uniform("uNoiseScale",n).draw(),Le.texture})(r),this._drawSim=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uTexBase;\nuniform sampler2D uTexPrev;\nuniform sampler2D uTexFlow;\nuniform sampler2D uTexRects;\nuniform float uSeed;\nuniform float uRatio;\nuniform float uCircleShape;\nuniform vec2 uDir;\nuniform vec2 uCenter;\n\nout vec4 oColor;\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\nvoid main(void) {\n    vec2 _uv = vTextureCoord - 0.5;\n    _uv.x *= uRatio;\n    _uv += 0.5;\n\n    vec3 rects = texture(uTexRects, vTextureCoord).rgb;\n\n    vec3 base = 1.0 - texture(uTexBase, vTextureCoord).rgb;\n    vec3 flow = texture(uTexFlow, _uv).rgb;\n    vec2 uv = vTextureCoord;\n    // uv.xy += flow.xy * mix(flow.z, 1.0, .2) * 0.025;\n    uv.xy += flow.xy * mix(flow.z, 1.0, .2) * 0.025;\n\n    float s = 1.0;\n    float n0 = snoise(vec3(uSeed, _uv) * s ) * .5 + .5;\n    float n = snoise(vec3(_uv, n0) * s ) * .5 + .5;\n    n = mix(0.5, 1.0, n);\n\n    uv += 0.05 * n * uDir * (1.0 - uCircleShape);\n\n    if(uCircleShape > 0.5) {\n        uv = (uv - 0.5) * (1.0 - uDir.x * 0.4) + 0.5;\n    } \n\n    vec3 color = texture(uTexPrev, uv).rgb;\n    color *= 0.8;\n    color += base;\n\n    oColor = vec4(color, 1.0);\n}").setClearColor(0,0,0,1).uniform("uDir",o).uniform("uRatio",s/a).uniform("uCenter",[.5,.5]).uniform("uSeed",(0,t.MX)()).uniform("uCircleShape",c?1:0),this.read.bind(),e.GL.clear(0,0,0,0),we.draw(n),this.read.unbind(),this.frame=Ie;this.frame<60;)this.update(),this.frame++}update(){this._drawSim.bindFrameBuffer(this.write).bindTexture("uTexBase",this._texturePattern,0).bindTexture("uTexPrev",this.read.texture,1).bindTexture("uTexFlow",this._textureNoise,2).draw(),this.swap(),60===this.frame&&(this.isFinished=!0)}get texture(){return this.read.texture}get pattern(){return this._texturePattern}get stopped(){return this.frame>60}}const Pe=Ne;class Fe extends e.hG{constructor(){super().setMesh(e.v6.plane(4,4,120,"xz")).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform sampler2D uHeightMap;\nuniform float uHeight;\n\nout vec2 vTextureCoord;\nout vec3 vNormal;\nout vec4 vWsPosition;\nout vec3 vPosition;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\n#define initRotation -0.5\n\nvoid main(void) {\n    vec3 pos = aVertexPosition;\n    float h = texture(uHeightMap, aTextureCoord).r;\n    pos.y += h * uHeight;\n\n    vWsPosition = uModelMatrix * vec4(pos, 1.0);\n    vPosition     = pos;\n\n    gl_Position = uProjectionMatrix * uViewMatrix * vWsPosition;\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nin vec3 vNormal;\nin vec3 vPosition;\nin vec4 vWsPosition;\n\nuniform sampler2D uInkMap;\nuniform sampler2D uHeightMap;\nuniform float uHeight;\nuniform float uInvert;\n\nfloat diffuse(vec3 n, vec3 l) {\n  float d = dot(normalize(n), normalize(l));\n  return max(d, 0.0);\n}\n\nfloat diffuse(vec3 n, vec3 l, float t) {\n  float d = dot(normalize(n), normalize(l));\n  return mix(1.0, max(d, 0.0), t);\n}\n\n#define LIGHT vec3(1.0, 0.8, 0.0)\n\nvec3 getNormal() {\n\tvec3 pos_dx = dFdx(vPosition);\n\tvec3 pos_dy = dFdy(vPosition);\n\tvec3 tex_dx = dFdx(vec3(vTextureCoord, 0.0));\n\tvec3 tex_dy = dFdy(vec3(vTextureCoord, 0.0));\n\tvec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n\tvec3 ng = normalize(vNormal);\n\n\tt = normalize(t - ng * dot(ng, t));\n\tvec3 b = normalize(cross(ng, t));\n\tmat3 tbn = mat3(t, b, ng);\n\n\tvec3 n = vec3(0.0);\n\tn = normalize(tbn * (2.0 * n - 1.0));\n\treturn n;\n}\n\n// layout (location = 0) out vec4 oFragColor0;\n// layout (location = 1) out vec4 oFragColor1;\n// layout (location = 2) out vec4 oFragColor2;\n// layout (location = 3) out vec4 oFragColor3;\n\nout vec4 oColor;\n\nvoid main(void) {\n    vec4 color = texture(uInkMap, vTextureCoord);\n\t\tcolor.rgb = 1.0 - color.rgb;\n\t\tcolor.rgb = smoothstep(vec3(0.2), vec3(.7), color.rgb);\n    // if( 1.0 - color.r < 0.01) discard;\n\n    // float height = texture2D(uHeightMap, vTextureCoord).r;\n    // if(height < 0.01) discard;\n\n    vec3 fdx = vec3(dFdx(vPosition.x), dFdx(vPosition.y), dFdx(vPosition.z));\n    vec3 fdy = vec3(dFdy(vPosition.x), dFdy(vPosition.y), dFdy(vPosition.z));\n\n    vec3 N = normalize(cross(fdx, fdy));\n\t\tfloat d = diffuse(N, LIGHT, .3);\n\n\t\tfloat t = smoothstep(0.8, 2.0, vPosition.y);\n\t\tcolor.rgb *= t * d;\n\t\tcolor.a = smoothstep(0.0, 0.1, color.r);\n\n    oColor = color;\n    // oFragColor0 = color;\n    // oFragColor1 = vec4(N, 1.0);\n    // oFragColor2 = vec4(vWsPosition.xyz, 1.0);\n\t\t// oFragColor3 = vec4(0.0, 0.0, 0.0, 1.0);\n}")}}let ze,De=0;class Ue extends e.Tm{constructor(){super(),ze||(ze=new Fe);const n=[.5,.5];this._textreInkMap=function(n=[.5,.5]){const{canvas:o,ctx:r,width:i,height:s}=(0,p.v)(1024,1024);r.fillStyle=(0,t.B8)(0),r.fillRect(0,0,i,s);const{sin:a,cos:c,PI:u}=Math,l=(e,o,l=0)=>{r.save(),r.translate(i*n[0]+(0,t.MX)(-l,l),s-s*n[1]+(0,t.MX)(-l,l));const h=(0,t.MX)(i);r.fillStyle=(0,t.m4)(255,255,255,o?1:.2),r.beginPath();for(let n=0;n<=120;n++){const o=n/120*u*2;let i=c(o)*e,s=a(o)*e,l=ee(i,s,h,(0,t.MX)(.004,.001));l=1+.25*l,i*=l,s*=l,0===n?r.moveTo(i,s):r.lineTo(i,s)}r.fill(),r.restore()};let h=6;for(;h--;)l(i*(0,t.MX)(.2,.4)*1,!1,100);return l(.2*i*1,!0),new e.fy(o)}(n),this._textureHeight=function(n=[.5,.5]){const o=t.gO?e.GL.HALF_FLOAT:e.GL.FLOAT,r=new e.uL(2048,2048,{type:o});return(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\n\nuniform vec2 uCenter;\nuniform float uSeed;\nuniform float uSlope;\nuniform float uSharp;\nuniform float uRotation;\n\nout vec4 oColor;\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise_0(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise_0(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\nvoid main(void) {\n    vec2 uv = vTextureCoord - 0.5;\n    uv = rotate(uv, uRotation);\n    uv.x *= 0.8;\n    uv += 0.5;\n    float d = distance(uv, uCenter);\n    d = smoothstep(0.5, uSharp, d);\n\n    // noise\n    float noise = fbm(vec3(vTextureCoord, uSeed) * 2.0);\n    float noise1 = fbm(vec3(vTextureCoord, uSeed) * 10.0);\n    noise += noise1 * 0.25;\n    d = pow(d, uSlope);\n    d += noise * 0.75 * d;\n\n    d *= 1.2;\n    oColor = vec4(vec3(d), 1.0);\n}").setClearColor(0,0,0,1).bindFrameBuffer(r).uniform("uSeed",(0,t.MX)(10)).uniform("uSharp",-.1).uniform("uSlope",(0,t.MX)(1.2,1.5)).uniform("uCenter",n).uniform("uRotation",(0,t.MX)(2*Math.PI)).draw(),r.texture}(n),this._textureInk=new Pe(this._textreInkMap,[-1,1],1,!0),this.height=1.5,this.scaleX=this.scaleY=this.scaleZ=1.5*(0,t.MX)(1.8,2),this.invert=!(De>2)&&(0,t.MX)()<.3,this.invert&&De++}draw(){e.GL.setModelMatrix(this.matrix),ze.bindTexture("uHeightMap",this._textureHeight,0).bindTexture("uInkMap",this._textureInk.texture,1).uniform("uHeight",this.height).uniform("uInvert",this.invert?1:0).draw()}}function Oe(){let n,o=(0,t.Iy)(3);return n=0===o?new Pe(function(){const{canvas:n,ctx:o,width:r,height:i}=(0,p.v)(f,v);o.fillStyle="#000",o.fillStyle="#fff",o.fillRect(0,0,r,i);const s=(0,t.MX)(i),a=s+50*(0,t.MX)(-1,1),c=(0,t.MX)(i),u=(0,t.MX)(i),h=(0,t.MX)(i),x=e=>{let n=[];for(let o=0;o<=200;o++){const i=o/200,u=(0,t.CD)(-.1,1.1,i)*r;let l=e;const h=500*-(.5*ne(u,l,s,.001)+.5),f=100*-(.5*ne(u,l,a,.001)+.5);let v=.5*ee(u,l,c,.001)+.5;v=(0,t.CW)(0,.6,v),l=e+(0,t.CD)(h,f,v),n.push([u,l])}const i=[.5*r,e],f=.5*(0,t.MX)(-1,1);n.forEach((e=>{l(e,e,i,f)})),n.forEach((e=>{let n=.5*ne(...e,u,.001,5)+.5,r=.5*ne(...e,h,.001,5)+.5;n=(0,t.CW)(0,1,n),n=Math.pow(n,2),r=(0,t.CW)(0,1,r);const i=(0,t.CD)(100,0,r),s=(0,t.CD)(40,120,n);((e,t,n=20,r)=>{r&&(o.fillStyle=r),o.beginPath(),o.arc(e,t,n,0,2*Math.PI),o.fill()})(e[0],e[1],s,(0,t.B8)(i))}))},d=i-200,_=(0,t.Iy)(3,6);for(let e=0;e<_;e++)x(100+d*((e+.5)/_));return new e.fy(n)}(),[0,1],1,!1).texture:1===o?new Pe(function(){const{canvas:n,ctx:o,width:r,height:i}=(0,p.v)(1080,1920);o.fillStyle=(0,t.B8)(255),o.fillRect(0,0,r,i),o.fillStyle=(0,t.B8)(0),o.translate(.5*r,.5*i),o.rotate(.2*(0,t.MX)(-1,1)),o.translate(.5*-r,.5*-i);const s=(e,t,n=20,r)=>{r&&(o.fillStyle=r),o.beginPath(),o.arc(e,t,n,0,2*Math.PI),o.fill()},{atan2:c,sqrt:u,floor:h}=Math,f=(e,n)=>{let r=[];const i=n[0]-e[0],f=n[1]-e[1],v=c(f,i),x=u(i*i+f*f),d=(0,t.MX)(1e3),_=(0,t.MX)(1e3),m=(0,t.MX)(1e3),p=h(.2*x);o.save(),o.translate(...e),o.rotate(v);const E=.001*(0,t.MX)(1,2);for(let e=0;e<p;e++){const n=(e+.5)/p*x,o=50*(te(n,d,E)-.5);let i=(0,t.uZ)(.5*te(n,_,.001)+.5,0,1);i=(0,t.CW)(.2,.8,i);const a=(0,t.CD)(2,20,i);let c=(0,t.uZ)(.5*te(n,m,.001)+.5,0,1);c=(0,t.CD)(0,200,c),s(n,o,a,(0,t.B8)(c)),r.push([n,o])}return o.restore(),r=r.map((t=>(l(t,t,[0,0],v),a(t,t,e),t))),r};return((e,n)=>{o.save(),o.translate(e,n),(0,t.MX)()>.5&&o.scale(-1,1);const r=[0,.6*i];l(r,r,[0,0],(0,t.MX)(.3,.5));const c=f([0,0],r),u=(0,t.MX)(-.6,-1),v=(0,t.MX)(-.2,-.4),x=e=>{s(...e,(0,t.MX)(5,20),(0,t.B8)(0))};c.forEach(x);const d=(0,t.Iy)(8,12);for(let e=0;e<d;e++){const n=e/d,o=c[h(n*c.length)],r=[0,(0,t.CD)(1800,200,n)];l(r,r,[0,0],(0,t.CD)(u,v,n)+.1*(0,t.MX)(-1,1));const i=a([],o,r);let s=f(o,i);0===e&&s.forEach(x)}o.restore()})(r*(0,t.MX)(.4,.6),i*(0,t.MX)(.2,.3)),new e.fy(n)}(),[0,1],1,!1).texture:function(){e.GL.enable(e.GL.DEPTH_TEST);const n=new e.uL(f,v),o=new e.ZR,r=Math.PI/180;o.setPerspective(30*r,.5625,.01,30),o.lookAt([0,8,7].map((e=>1*e)),[0,0,0]);const i=[];for(let e=0;e<2;e++){const n=new Ue;n.x=(0,t.MX)(-1,.7);const o=(e+.5)/2;n.z=(0,t.CD)(-1.5,1.5,o),n.y=(0,t.CD)(-1.5,-3.5,o)-3,i.push(n)}return n.bind(),e.GL.clear(.1,.1,.1,1),e.GL.setMatrices(o),i.forEach((e=>e.draw())),n.unbind(),e.GL.disable(e.GL.DEPTH_TEST),n.texture}(),function(n,o=1,r=1){const{width:i,height:s}=n,a=i/s,c=new e.uL(i,s),u=new e.ZR;u.setPerspective(.25*Math.PI,a,.01,100),u.lookAt([0,5,7],[0,0,0]);const l=(()=>{const n=new e.Kj(e.GL.POINTS);let r=Math.floor(1e5*o);const i=[],s=[],c=[],u=2.5/a;for(;r--;)i.push([(0,t.MX)(-2.5,2.5),(0,t.MX)(-u,u),(0,t.MX)()]),s.push([(0,t.MX)(),(0,t.MX)(),(0,t.MX)()]),c.push(r);return n.bufferVertex(i).bufferNormal(s).bufferIndex(c),n})();return u.lookAt([0,0,10],[0,0,0]),e.GL.setMatrices(u),(new e.hG).setMesh(l).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform sampler2D uMap;\nuniform float uDotScale;\n\nout vec3 vColor;\nout vec3 vExtra;\nout float vSkip;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\n#define PI 3.1415926535897932384626433832795\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);\n    vec2 uv = gl_Position.xy / gl_Position.w * .5 + .5;\n\n    float g = texture(uMap, uv).r;\n    g = smoothstep(0.0, 1.0, g);\n    float maxSize = mix(1.0, 80.0, g);\n\n    float pointSize = mix(1.0, maxSize, aVertexPosition.z) * uDotScale;\n    gl_PointSize = pointSize;\n    vSkip = step(pointSize, 1.0);\n    vColor = vec3(g);\n    vExtra = aNormal;\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 vColor;\nin vec3 vExtra;\nin float vSkip;\nout vec4 oColor;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\n#define PI 3.1415926535897932384626433832795\n\nvoid main(void) {\n    if(vSkip > .5) discard;\n    vec2 uv = gl_PointCoord - 0.5;\n    uv = rotate(uv, vExtra.z * PI * 2.0);\n    uv.x /= mix(0.2, 1.0, vExtra.y);\n\n    float d = length(uv);\n    float t = fbm(vec3(uv, vExtra.x) * 4.0);\n    float r = mix(0.1, 0.5, t);\n    if(d > r) discard;\n\n    oColor = vec4(vColor, 1.0);\n}").setClearColor(0,0,0,1).bindFrameBuffer(c).bindTexture("uMap",n,0).uniform("uDotScale",r).draw(),c.texture}(n)}let Be,Ge,Xe=0;function Ve(){if(!Ge){const n=.5,o=1080*n,r=1920*n;Ge=new e.uL(o,r),Be=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform float uSeed;\nuniform float uRatio;\nuniform float uTime;\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nout vec4 oColor;\n\nvoid main(void) {\n\n    vec2 uv = vTextureCoord;\n    uv.y /= uRatio;\n    uv.y -= uTime * 0.5;\n\n    vec3 pos = vec3(uv, uTime * 0.75) * 2.0;\n    float n = fbm(pos);\n    n = smoothstep(0.2, 0.8, n);\n    oColor = vec4(vec3(n), 1.0);    \n\n}").setClearColor(0,0,0,0).bindFrameBuffer(Ge).uniform("uSeed",(0,t.MX)(10)).uniform("uRatio",o/r)}return Be.uniform("uTime",Xe).draw(),Xe+=.0015,Ge.texture}class ke extends e.xs{constructor(){super(),n.Z.usePoseDetection&&this._initPoseDetection(),window.addEventListener("mousedown",(()=>{console.log("mouse down"),AudioContext?de||(de=!0,oe=new AudioContext,le=(0,t.MX)(10),fe=(0,t.MX)(10),ve=(0,t.MX)(.1,.5),xe=(0,t.MX)(.5,1),he=new e.Wu(0,.02),(0,t.MX)()<.5?(()=>{const e=oe.createBuffer(1,3*oe.sampleRate,oe.sampleRate),n=e.getChannelData(0);for(let e=0;e<3*oe.sampleRate;e++)n[e]=Math.random(-1,1);se=oe.createGain(),se.connect(oe.destination),se.gain.setValueAtTime(0,oe.currentTime),ce=oe.createBiquadFilter(),ce.type="lowpass",ce.frequency.setValueAtTime(500,oe.currentTime),ce.Q.setValueAtTime(1,oe.currentTime),ce.connect(se),re=oe.createBufferSource(),re.buffer=e,re.connect(ce),re.loop=!0,re.start();const o=oe.createBuffer(1,3*oe.sampleRate,oe.sampleRate),r=o.getChannelData(0);var i,s,a,c,u,l,h;i=s=a=c=u=l=h=0;for(let e=0;e<3*oe.sampleRate;e++){var f=2*(0,t.MX)()-1;i=.99886*i+.0555179*f,s=.99332*s+.0750759*f,a=.969*a+.153852*f,c=.8665*c+.3104856*f,u=.55*u+.5329522*f,l=-.7616*l-.016898*f,r[e]=i+s+a+c+u+l+h+.5362*f,h=.115926*f}ae=oe.createGain(),ae.connect(oe.destination),ae.gain.setValueAtTime(.2,oe.currentTime),ue=oe.createBiquadFilter(),ue.type="lowpass",ue.frequency.setValueAtTime(100,oe.currentTime),ue.Q.setValueAtTime(.01,oe.currentTime),ue.connect(ae),ie=oe.createBufferSource(),ie.buffer=o,ie.connect(ue),ie.loop=!0,ie.start(),A.Z.addEF((()=>{let e=.2+Math.pow(_e(.015*fe),3);e*=he.value,se.gain.setValueAtTime(1*e,oe.currentTime),ae.gain.setValueAtTime(.05*e,oe.currentTime),ue.frequency.setValueAtTime(Math.max(0+1e3*(1-e),0),oe.currentTime)}))})():(()=>{const e=oe.createBuffer(1,3*oe.sampleRate,oe.sampleRate),t=e.getChannelData(0);for(let e=0;e<3*oe.sampleRate;e++)t[e]=Math.random(-1,1);se=oe.createGain(),se.connect(oe.destination),se.gain.setValueAtTime(1,oe.currentTime),ce=oe.createBiquadFilter(),ce.type="lowpass",ce.frequency.setValueAtTime(5e3,oe.currentTime),ce.Q.setValueAtTime(.1,oe.currentTime),ce.connect(se),re=oe.createBufferSource(),re.buffer=e,re.connect(ce),re.loop=!0,re.start(),A.Z.addEF((()=>{let e=.2+.9*Math.pow(_e(.015*fe),3)+.1*Math.pow(_e(.1*fe),3);e*=he.value,se.gain.setValueAtTime(.2*e,oe.currentTime)}))})(),setTimeout((()=>{he.value=1}),1e3),A.Z.addEF((()=>{fe+=ve}))):console.log("AudioContext is not supported")})),this.swtichScene(),this._toRestart=!1,setTimeout((()=>{this._toRestart=!0}),6e4)}_initParameters(){e.GL.disable(e.GL.DEPTH_TEST),this.orbitalControl.radius.setTo(10),this.orbitalControl.update(),this.orbitalControl.lock();const r=.985;this._fluid=new class{constructor(e={}){this.settings={...B};for(let t in e)this.settings[t]&&(this.settings[t]=e[t]);this._initTextures(),this._initDrawCalls()}_initTextures(){const{TEXTURE_SIZE:n}=this.settings;this._texelSize=[1/n,1/n];const o=t.gO?e.GL.HALF_FLOAT:e.GL.FLOAT,r={minFilter:e.GL.LINEAR,magFilter:e.GL.LINEAR,wrapS:e.GL.MIRRORED_REPEAT,wrapT:e.GL.MIRRORED_REPEAT,type:o};this._fboVelocity=new e.SY(n,n,r),this._fboDensity=new e.SY(n,n,r),this._fboPressure=new e.SY(n,n,r),this._fboDivergence=new e.uL(n,n,r),this._fboVelocity.read.bind(),this._fboVelocity.read.unbind(),this._fboVelocity.write.bind(),this._fboVelocity.write.unbind(),this._fboDensity.read.bind(),this._fboDensity.read.unbind(),this._fboDensity.write.bind(),this._fboDensity.write.unbind(),this._fboPressure.read.bind(),this._fboPressure.read.unbind(),this._fboPressure.write.bind(),this._fboPressure.write.unbind(),this._fboDivergence.bind(),this._fboDivergence.unbind()}_initDrawCalls(){const t=e.v6.bigTriangle(),n="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 aPosition;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTextureCoord = aPosition * .5 + .5;\n}";this._drawAdvect=(new e.hG).useProgram(n,S()).setMesh(t).setClearColor(0,0,0,1).uniform("uTimestep","float",1e-4).uniform("uTimestep","float",25e-5).uniform("uTexelSize","vec2",this._texelSize),this._drawDivergence=(new e.hG).useProgram(n,M()).setMesh(t).setClearColor(0,0,0,1).bindFrameBuffer(this._fboDivergence).uniform("uTexelSize","vec2",this._texelSize),this._drawClear=(new e.hG).useProgram(n,w()).setMesh(t).setClearColor(0,0,0,1).uniform("uDissipation","float",this.settings.PRESSURE_DISSIPATION),this._drawJacobi=(new e.hG).useProgram(n,N()).setMesh(t).setClearColor(0,0,0,1).uniform("uTexelSize","vec2",this._texelSize),this._drawGradient=(new e.hG).useProgram(n,F()).setMesh(t).setClearColor(0,0,0,1).uniform("uTexelSize","vec2",this._texelSize),this._drawSplat=(new e.hG).useProgram(n,D()).setMesh(t),this._drawAdd=(new e.hG).useProgram(n,O()).setMesh(t)}updateFlow(e,t,n=1,o=1,r=0){const i=500*n,s=2*A.Z.getElapsedTime();this._drawSplat.bindFrameBuffer(this._fboVelocity.write).uniform("uTime","float",s).uniform("uCenter","vec2",e).uniform("uRadius","float",.05*o).uniform("uStrength","float",i).uniform("uNoiseStrength","float",r).uniform("uIsVelocity","float",1).uniform("uDir","vec2",t).uniformTexture("texture",this._fboVelocity.read.texture,0).draw(),this._fboVelocity.swap(),this._drawSplat.bindFrameBuffer(this._fboDensity.write).uniform("uCenter","vec2",e).uniform("uIsVelocity","float",0).uniform("uStrength","float",.05).uniform("uNoiseStrength","float",r).uniform("uDir","vec2",t).uniformTexture("texture",this._fboDensity.read.texture,0).draw(),this._fboDensity.swap()}updateFlowWithMap(e,t,n=1){this._drawAdd.bindFrameBuffer(this._fboVelocity.write).uniformTexture("textureBase",this._fboVelocity.read.texture,0).uniformTexture("textureAdd",e,1).uniform("uStrength","float",1e3*n).draw(),this._fboVelocity.swap(),this._drawAdd.bindFrameBuffer(this._fboDensity.write).uniformTexture("textureBase",this._fboDensity.read.texture,0).uniformTexture("textureAdd",t,1).uniform("uStrength","float",.02).draw(),this._fboDensity.swap()}advect(e,t,n){this._drawAdvect.bindFrameBuffer(e).uniformTexture("textureVel",this._fboVelocity.read.texture,0).uniformTexture("textureMap",t,1).uniform("uDissipation","float",n).draw()}update(){this.advect(this._fboVelocity.write,this._fboVelocity.read.texture,this.settings.VELOCITY_DISSIPATION),this._fboVelocity.swap(),this.advect(this._fboDensity.write,this._fboDensity.read.texture,this.settings.DENSITY_DISSIPATION),this._fboDensity.swap(),this._drawDivergence.uniformTexture("textureVel",this._fboVelocity.read.texture,0).draw(),this._drawClear.bindFrameBuffer(this._fboPressure.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).draw(),this._fboPressure.swap();for(let e=0;e<this.settings.PRESSURE_ITERATIONS;e++)this._drawJacobi.bindFrameBuffer(this._fboPressure.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).uniformTexture("textureDivergence",this._fboDivergence.texture,1).draw(),this._fboPressure.swap();this._drawGradient.bindFrameBuffer(this._fboVelocity.write).uniformTexture("texturePressure",this._fboPressure.read.texture,0).uniformTexture("textureVel",this._fboVelocity.read.texture,1).draw(),this._fboVelocity.swap()}get velocity(){return this._fboVelocity.read.texture}get density(){return this._fboDensity.read.texture}get divergence(){return this._fboDivergence.texture}get pressure(){return this._fboPressure.read.texture}get allTextures(){return[this.velocity,this.density,this.divergence,this.pressure]}log(){console.log("Fluid Settings : ");for(let e in this.settings)console.log(e,this.settings[e])}}({DENSITY_DISSIPATION:r,VELOCITY_DISSIPATION:r,PRESSURE_DISSIPATION:r});const i=e.v6.plane(15,15,1),s=new e.l(i,this.camera);this._hit=[0,0,0],this._preHit=[0,0,0];const a=[0,0,0];s.on("onHit",(e=>{o.JG(this._hit,e.hit),o.lu(a,this._hit,this._preHit),o.Fv(a,a);const n=this._hit[0]/15+.5,r=this._hit[1]/15+.5;this._fluid.updateFlow([n,r],[a[0],a[1]],2,(0,t.MX)(2,4),.2),o.JG(this._preHit,this._hit)})),this._drawHitPlane=(new e.hG).setMesh(i).useProgram("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec3 aVertexPosition;\nin vec2 aTextureCoord;\nin vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nout vec2 vTextureCoord;\nout vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}","#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\n\nout vec4 oColor;\n\nvoid main(void) {\n    float r = texture(uMap, vTextureCoord).r;   \n    r = smoothstep(0.0, 1.2, r) * .99;\n    oColor = vec4(r, r, r, 1.0);\n\n    // oColor = vec4(vTextureCoord.xxx, 1.0);\n}"),((e,n)=>{X=e;const o=7.5;V=[[-o,0],[-2.5,8*(0,t.MX)(-1,0)],[2.5,8*(0,t.MX)(0,1)],[o,0]];let r=(0,t.MX)(-1,1)*Math.PI*.25+(0,t.Iy)(2)*Math.PI;V.forEach((e=>{l(e,e,[0,0],r)}));let i=4;const s=.5/(i+1);k=[];for(let e=0;e<=i;e++){const n=e/i,o=G(V,n),r=[o[0],o[1],0],a=G(V,n+s);h(a,a,o),c(a,a),l(a,a,[0,0],.95*(0,t.MX)(-1,1)),o[0]=o[0]/15+.5,o[1]=o[1]/15+.5,k.push({pos:o,dir:a,pos3D:r})}i=2;for(let e=0;e<=i;e++){const n=e/i,o=G(V,n),r=[o[0],o[1],0],f=G(V,n+s);h(f,f,o),c(f,f),u=f,-1,(a=f)[0]=-1*u[0],a[1]=-1*u[1],l(f,f,[0,0],.95*(0,t.MX)(-1,1)),o[0]=o[0]/15+.5,o[1]=o[1]/15+.5,k.push({pos:o,dir:f,pos3D:r})}var a,u})(this._fluid),this._flowForce=new e.Wu(0),this._flowForce.value=1,this._colorFrame=new d.Z(n.Z.bgColor),this._colorFrame.lightness=Math.max(.9,this._colorFrame.lightness),this._isPresenting=!1,this._isAnimating=!1,this._userDetected=!1,this._isClosing=!1}swtichScene(){this._isAnimating&&this.toggleAnimation(),this._isPresenting=!this._isPresenting,this.resize(),this._isPresenting?this.resume():(this.stop(),this.render(),this.render())}_initPoseDetection(){this._poseDetection=new R,this._poseDetection.on(g,this._onPoseFound),this._poseDetection.on(y,(()=>{this._flowForce.value=1,this._userDetected=!1}))}_onPoseFound=e=>{if(this._posePoints){const n=.5;e.forEach((({pos:e,score:o},r)=>{const i=h([0,0],e,this._posePoints[r]);let s=function(e){var t=e[0],n=e[1];return Math.hypot(t,n)}(i);if(c(i,i),o>n){let n=(0,t.CW)(.01,.03,s);const o=(0,t.CD)(1,4,n),r=(0,t.CD)(2,10,n);this._fluid.updateFlow(e,i,r,o,.5)}var a,u;u=e,(a=this._posePoints[r])[0]=u[0],a[1]=u[1]}))}else this._posePoints=e.map((({pos:e})=>e));this._flowForce.value=0,this._userDetected=!0};_initTextures(){this.resize(),this._initParameters(),this._textureChars=Se(),this._texturePaper=function(){const n=new e.uL(2048,2048);return(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\n\nuniform float uSeed;\nuniform float uRatio;\n\nfloat diffuse(vec3 n, vec3 l) {\n  float d = dot(normalize(n), normalize(l));\n  return max(d, 0.0);\n}\n\nfloat diffuse(vec3 n, vec3 l, float t) {\n  float d = dot(normalize(n), normalize(l));\n  return mix(1.0, max(d, 0.0), t);\n}\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nout vec4 oColor;\n\nfloat getHeight(vec2 uv) {\n    float hScale = 2.0;\n    vec3 posNoise = vec3(uv, uSeed);\n\n    float t = 1.0;\n    float base = smoothstep(-t, t, snoise(posNoise.xzy));\n\n    float noiseScale = 40.0;\n    t = 0.2;\n\n    float nBase = smoothstep(t, 1.0-t, fbm(posNoise * noiseScale * mix(1.0, 1.2, base))) * hScale;\n    noiseScale = noiseScale * 12.0;\n    float nTop = smoothstep(t, 1.0-t, fbm(posNoise * noiseScale * mix(1.0, 1.2, base))) * hScale;\n    return mix(nBase, nTop, 0.2);\n}\n\nvoid main(void) {\n    vec2 uv = vTextureCoord;\n    uv.y /= uRatio;\n\n    vec3 offset = vec3(-1.0, 0.0, 1.0) * 0.001;\n    \n\n    float s11 = getHeight(uv);\n    float s01 = getHeight(uv + offset.xy);\n    float s21 = getHeight(uv + offset.zy);\n    float s10 = getHeight(uv + offset.yx);\n    float s12 = getHeight(uv + offset.yz);\n\n    vec2 size = vec2(2.0,0.0);\n\n    vec3 va = normalize(vec3(size.xy,s21-s01));\n    vec3 vb = normalize(vec3(size.yx,s12-s10));\n    // vec3 n = normalize(cross(va,vb) + fbm(vec3(uv, uSeed) * 100.0) * 0.1);\n    vec3 n = normalize(cross(va,vb));\n\n    vec3 light = vec3(0.3, 0.3, 1.0);\n    // float d = diffuse(n, light, .5);\n    float d = diffuse(n, light);\n    \n    oColor = vec4(vec3(d), 1.0);\n    // gl_FragColor = vec4(n, 1.0);\n}").setClearColor(1,1,1,1).bindFrameBuffer(n).uniform("uSeed",(0,t.MX)()).uniform("uRatio",1).draw(),n.texture}(),this._textureStrokes=function(){const n=new be,{width:r,height:i}=e.GL,s=new e.uL(r,i),a=new e.uL(r,i),{PI:c}=Math,u=new e.Ag(0,r,0,i,.1,1e4);u.lookAt([0,0,100],[0,0,0]),e.GL.disable(e.GL.CULL_FACE),e.GL.disable(e.GL.DEPTH_TEST);const l=[0,0,0],h=[r/2,i/2,0],f=()=>{const e=(0,t.MX)(2*c),n=1.5*o.kE(h),s=[n,0,0],a=[n,0,0];o.jI(s,s,l,e),o.jI(a,a,l,e+(0,t.MX)(.8,3));let u=.5;const f=o.d9(s);o.bA(f,f,-(0,t.MX)(.4,.3)),o.jI(f,f,l,(0,t.MX)(-u,u));const v=o.d9(a);o.bA(v,v,-(0,t.MX)(.4,.3)),o.jI(v,v,l,(0,t.MX)(-u,u));const x=[s,f,v,a],d=(0,t.MX)(-1,1)*r*.5,_=(0,t.MX)(-1,1)*i*.5;return x.forEach((e=>{o.IH(e,e,h),o.IH(e,e,[d,_,0])})),x};let v=14,x=[];for(;v--;)x.push(f());return s.bind(),e.GL.clear(1,1,1,1),e.GL.setMatrices(u),x.forEach((e=>{e.forEach(((e,t)=>{n.uniform(`uPoint${t}`,e)})),n.uniform("uWetness",(0,t.MX)(.4,.5)).uniform("uSeeds",[(0,t.MX)(),(0,t.MX)(),(0,t.MX)()]).uniform("uNoiseScale",(0,t.MX)(1,2)).uniform("uLineWidthScale",(0,t.MX)(1,1.5)).draw()})),s.unbind(),(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform float uRatio;\n\nout vec4 oColor;\n\nfloat getHeight(vec2 uv) {\n    float h = texture(uMap, uv).r;\n    return h;\n}\n\nfloat diffuse(vec3 n, vec3 l) {\n  float d = dot(normalize(n), normalize(l));\n  return max(d, 0.0);\n}\n\nfloat diffuse(vec3 n, vec3 l, float t) {\n  float d = dot(normalize(n), normalize(l));\n  return mix(1.0, max(d, 0.0), t);\n}\n\n#define LIGHT vec3(0.0, 1.0, 1.0)\n\nvoid main(void) {\n    vec2 uv = vTextureCoord;\n    // uv.y += 0.05;\n    vec3 offset = vec3(-1.0, 0.0, 1.0) * 0.002;\n    \n\n    float s11 = getHeight(uv);\n    float s01 = getHeight(uv + offset.xy);\n    float s21 = getHeight(uv + offset.zy);\n    float s10 = getHeight(uv + offset.yx);\n    float s12 = getHeight(uv + offset.yz);\n\n    vec2 size = vec2(2.0,0.0);\n\n    vec3 va = normalize(vec3(size.xy,s21-s01));\n    vec3 vb = normalize(vec3(size.yx,s12-s10));\n    vec3 n = normalize(cross(va,vb));\n\n    float d = diffuse(n, LIGHT);\n    float t = 0.3;\n    d = smoothstep(1.0, 0.3, d);\n\n    oColor = vec4(s11, d, 0.0, 1.0);\n    // oColor = vec4(vec3(s11), 1.0);\n    // oColor = vec4(vec3(d), 1.0);\n}").setClearColor(0,0,0,1).bindFrameBuffer(a).bindTexture("uMap",s.texture,0).uniform("uRatio",s.width/s.height).draw(),a.texture}(),this._textureNoise=function(){const n=new e.uL(e.GL.width,e.GL.height);return(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform float uRatio;\nuniform vec3 uSeed;\n\nout vec4 oColor;\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, s, -s, c);\n\treturn m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n\tmat4 m = rotationMatrix(axis, angle);\n\treturn (m * vec4(v, 1.0)).xyz;\n}\n\n// snoise.glsl\nvec4 permute(vec4 x) {  return mod(((x*34.0)+1.0)*x, 289.0);    }\nvec4 taylorInvSqrt(vec4 r) {    return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat snoise(vec3 v){\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n    \n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    \n    vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n    vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n    vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    i = mod(i, 289.0 );\n    vec4 p = permute( permute( permute( i.z + vec4(0.0, i1.z, i2.z, 1.0 )) + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    float n_ = 1.0/7.0;\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n    return snoise(vec3(x, y, z));\n}\n\n#define NUM_OCTAVES 5\n\nfloat mod289(float x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}\nvec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}\n\nfloat noise(vec3 p){\n    vec3 a = floor(p);\n    vec3 d = p - a;\n    d = d * d * (3.0 - 2.0 * d);\n\n    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n    vec4 k1 = perm(b.xyxy);\n    vec4 k2 = perm(k1.xyxy + b.zzww);\n\n    vec4 c = k2 + a.zzzz;\n    vec4 k3 = perm(c);\n    vec4 k4 = perm(c + 1.0);\n\n    vec4 o1 = fract(k3 * (1.0 / 41.0));\n    vec4 o2 = fract(k4 * (1.0 / 41.0));\n\n    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\n    return o4.y * d.y + o4.x * (1.0 - d.y);\n}\n\nfloat fbm(vec3 x) {\n\tfloat v = 0.0;\n\tfloat a = 0.5;\n\tvec3 shift = vec3(100);\n\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\tv += a * noise(x);\n\t\tx = x * 2.0 + shift;\n\t\ta *= 0.5;\n\t}\n\treturn v;\n}\n\nvoid main(void) {\n    vec2 uv = vTextureCoord;\n    uv.y /= uRatio;\n\n    float ns = 20.0;\n    uv *= 1.2 * ns;\n\n    float n = snoise(vec3(uv, uSeed.x));\n    float t = 0.5;\n\n    uv = rotate(uv, 0.7);\n    float n0 = fbm(vec3(uv * 2.0, uSeed.y)) - 0.5;\n    n += n0 * 0.5;\n\n    float n1 = fbm(vec3(uv * 4.0, uSeed.z));\n    n += n1 * 0.25;\n\n    n = smoothstep(-0.2, 1.0, n);\n    n = mix(0.1, .99, n);\n    // n *= .99;\n\n    oColor = vec4(n, n, n, 1.0);\n}").setClearColor(0,0,0,0).bindFrameBuffer(n).uniform("uSeed",[(0,t.MX)(10),(0,t.MX)(10),(0,t.MX)(10)]).uniform("uRatio",e.GL.aspectRatio).draw(),n.texture}(),this._textureMask=Ve(),this._texturePattern=Oe(),this._fboMap=new e.uL(1024,1024),this._fboSplats=new e.uL(e.GL.width,e.GL.height),this._fboRender=new e.SY(e.GL.width,e.GL.height)}_initViews(){this._dCopy=new e.Cg,this._drawChars=new ge(this.camera,.6),this._drawFrame=new Re,this._drawSplats=(new Ae).setClearColor(0,0,0,0).bindFrameBuffer(this._fboSplats),this._drawBlend=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform sampler2D uBaseMap;\nuniform float uNormalBlend;\n\nout vec4 oColor;\n\nvoid main(void) {\n    vec4 colorBase = texture(uBaseMap, vTextureCoord);\n    vec4 colorMap = texture(uMap, vTextureCoord);\n\n    // vec4 colorMul = uNormalBlend > .5 ? colorMap : colorBase * colorMap;\n    vec4 colorMul = mix(colorBase * colorMap, colorMap, uNormalBlend);\n\n    oColor = mix(colorBase, colorMul, colorMap.a);\n}").setClearColor(0,0,0,1),this._drawBlendStroke=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform sampler2D uStrokeMap;\n\nout vec4 oColor;\n\nfloat blendOverlay(float base, float blend) {\n\treturn base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend) {\n\treturn vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));\n}\n\nvec3 blendOverlay(vec3 base, vec3 blend, float opacity) {\n\treturn (blendOverlay(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvoid main(void) {\n    vec4 color = texture(uMap, vTextureCoord);\n    vec3 colorOverlay = texture(uStrokeMap, vTextureCoord).rgb;\n\n    vec3 colorStroke = colorOverlay.rrr;\n    colorStroke = vec3(1.0);\n    float br = colorOverlay.g;\n\n    colorStroke = mix(colorStroke, vec3(0.0), .2);\n    color.rgb += br * 0.1;\n    color.rgb = blendOverlay(color.rgb, colorStroke, 0.3);\n    // color.rgb = colorOverlay.ggg;\n    oColor = color;\n}").setClearColor(0,0,0,1),this._drawCompose=(new e.hG).setMesh(e.v6.bigTriangle()).useProgram(e.jz.bigTriangleVert,"#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\nin vec2 vTextureCoord;\nuniform sampler2D uMap;\nuniform sampler2D uPaperMap;\n\nuniform float uRatio;\n\nout vec4 oColor;\n\nvec3 greyscale(vec3 color, float str) {\n    float g = dot(color, vec3(0.299, 0.587, 0.114));\n    return mix(color, vec3(g), str);\n}\n\nvoid main(void) {\n    vec2 uv = vTextureCoord;\n    if(uRatio > 1.0) {\n        uv.y /= uRatio;  \n    } else {\n        uv.x *= uRatio;\n    }\n    vec3 paper = texture(uPaperMap, uv).rgb;\n    paper = mix(paper, vec3(1.0), .3);\n\n    vec4 color = texture(uMap, vTextureCoord);\n    color.rgb *= paper;\n\n    // vignette\n    uv = abs(vTextureCoord - .5);\n    if(uRatio > 1.0) {\n        uv.y /= uRatio;  \n    } else {\n        uv.x *= uRatio;\n    }\n\n    float d = length(uv);\n    float vignette = smoothstep(.6, .2, d);\n    color.rgb *= mix(.85, 1.0, vignette);\n\n    float g = length(color.rgb);\n\n    // color.rgb = greyscale(color.rgb, .8);\n    // color.rgb *= vec3(1.0, .97, .94);\n\n    // color.rgb = paper;\n    oColor = color;\n}");const o=(0,t.MX)()<.5,r=(0,t.ei)([.5,1,2]),i=o?r:r*(0,t.Iy)(2,5),s=new Ce(this.camera,[.05,0],r),a=new Ce(this.camera,[.02,0],r,!1,s.extras),c=new Ce(this.camera,[0,0],i,!0,o?s.extras:[]);this._layers=[s,a,c];const{bgColor:u}=n.Z,l=u.map(t.sg).map((e=>.9*e));this._drawLine=new ye(i).uniform("uColor",l)}update(){var e;this._isPresenting?(e=this._flowForce.value,k.forEach((({pos:n,dir:o})=>{const r=(s=o,(a=new i.WT(2))[0]=s[0],a[1]=s[1],a);var s,a;const c=.5*Math.PI;l(r,r,[0,0],(0,t.MX)(-1,1)*c);const u=(0,t.MX)(1,5)*e,h=(0,t.MX)(1,2)*e;X.updateFlow(n,r,u,h,.5)})),this._fluid.update(),this._drawHitPlane.bindFrameBuffer(this._fboMap).setClearColor(0,0,0,1).bindTexture("uMap",this._fluid.density,0).draw()):this._textureMask=Ve()}_applySplats(e){const{normalBlend:t}=n.Z;this._drawSplats.uniform("uColors","vec3",e.flat()).draw(),this._drawBlend.bindFrameBuffer(this._fboRender.write).bindTexture("uBaseMap",this._fboRender.read.texture,0).bindTexture("uMap",this._fboSplats.texture,1).uniform("uNormalBlend",t?1:0).draw(),this._fboRender.swap()}_addFrame(){this._fboRender.read.bind(),this._drawFrame.uniform("uColor",(0,t.Gv)(1.2)).uniform("uColor",this._colorFrame.glsl).uniform("uFrameSize",.76).draw(),this._fboRender.read.unbind()}_applyStroke(){this._drawBlendStroke.bindFrameBuffer(this._fboRender.write).bindTexture("uMap",this._fboRender.read.texture,0).bindTexture("uStrokeMap",this._textureStrokes,1).draw(),this._fboRender.swap()}render(){e.GL.clear(0,0,0,1),e.GL.setMatrices(this.camera);const{bgColor:o,color0:r,color1:i,color2:s,normalBlend:a}=n.Z,c=[r,i,s].map((e=>e.map(t.sg)));this._fboRender.read.bind(),e.GL.clear(...o.map(t.sg),1),this._drawLine.draw(),this._fboRender.read.unbind(),!this._isPresenting&&this._applyStroke();let u=this._isPresenting?this._fboMap.texture:this._textureNoise;this._layers.forEach(((e,t)=>{t<=2&&(e.render(u,this._textureChars,this._texturePattern,this._textureMask,c[t],this._isPresenting,this._isAnimating),this._drawBlend.bindFrameBuffer(this._fboRender.write).bindTexture("uBaseMap",this._fboRender.read.texture,0).bindTexture("uMap",e.texture,1).uniform("uNormalBlend",a?1:0).draw(),this._fboRender.swap())})),this._isPresenting||(this._applySplats(c),this._addFrame()),this._drawCompose.bindTexture("uMap",this._fboRender.read.texture,0).bindTexture("uPaperMap",this._texturePaper,1).uniform("uRatio",e.GL.aspectRatio).draw()}resize(){if(this._isPresenting){const t=1,{innerWidth:n,innerHeight:o}=window;e.GL.setSize(n*t,o*t),(0,x.hl)(e.GL.canvas)}else e.GL.setSize(f,v),(0,x.Tj)(e.GL.canvas,f,v);this.camera?.setAspectRatio(e.GL.aspectRatio),this._fboRender&&(this._fboRender=new e.SY(e.GL.width,e.GL.height)),this._layers?.forEach((e=>e.resize()))}}const He=ke,We=[];let je;const Ye=t=>{je=t.map((({id:t,file:n,type:o})=>{const r=n;let i;switch(o){case"jpg":case"png":i=new e.fy(n)}return{id:t,source:r,type:o,file:i}})),console.table(je)};var Ze=r(719),Ke=r.n(Ze);r(943);const qe=[{name:"立春",theme:[[[255,247,155],[255,238,111],[236,212,82],[182,160,20]],[[213,235,225],[177,213,200],[153,188,172],[128,164,146]],[[139,112,66],[119,80,57],[95,67,33],[66,37,23]],[[243,166,148],[238,121,89],[186,81,64],[193,44,31]]]},{name:"雨水",theme:[[[249,211,227],[236,176,193],[221,118,148],[167,98,131]],[[190,177,170],[180,146,115],[164,95,68],[107,84,88]],[[229,168,75],[225,138,59],[152,79,49],[124,70,30]],[[192,214,149],[169,190,123],[119,150,73],[79,111,70]]]},{name:"驚蟄",theme:[[[186,91,73],[166,64,54],[158,42,34],[124,25,30]],[[246,190,200],[240,145,160],[220,107,130],[195,92,93]],[[254,220,94],[250,192,61],[219,155,52],[198,121,21]],[[154,167,177],[107,121,142],[69,70,94],[44,47,59]]]},{name:"春分",theme:[[[235,238,232],[235,237,223],[224,224,208],[199,198,182]],[[210,175,157],[188,131,107],[178,109,93],[154,102,85]],[[234,85,20],[210,57,24],[200,22,29],[167,33,38]],[[50,113,174],[0,113,117],[40,72,82],[18,38,79]]]},{name:"清明",theme:[[[166,85,157],[138,24,116],[108,33,109],[66,34,86]],[[190,194,179],[157,157,130],[145,145,119],[121,131,108]],[[211,204,214],[155,142,169],[126,82,127],[102,61,116]],[[203,92,131],[184,53,112],[167,55,102],[144,55,84]]]},{name:"穀雨",theme:[[[220,199,225],[187,161,203],[166,126,183],[125,82,132]],[[168,191,143],[104,148,92],[76,128,69],[68,106,55]],[[174,208,238],[110,155,197],[53,78,107],[19,57,62]],[[189,130,83],[148,86,53],[128,76,46],[91,50,34]]]},{name:"立夏",theme:[[[195,217,78],[183,211,50],[158,188,25],[132,167,41]],[[223,206,180],[191,167,130],[180,155,127],[148,120,79]],[[190,194,188],[168,161,156],[146,137,123],[112,105,93]],[[242,154,118],[237,109,61],[233,72,41],[230,0,18]]]},{name:"小滿",theme:[[[226,162,172],[221,107,123],[194,81,96],[184,26,53]],[[106,141,82],[93,131,81],[79,121,74],[42,110,63]],[[212,201,170],[180,163,121],[158,131,88],[129,102,59]],[[242,200,103],[211,162,55],[208,134,53],[159,96,39]]]},{name:"芒種",theme:[[[213,209,174],[191,192,150],[169,168,134],[146,144,93]],[[179,181,156],[168,176,146],[169,167,115],[134,140,78]],[[221,187,153],[210,163,108],[190,148,87],[180,136,77]],[[83,81,100],[69,70,89],[52,48,65],[30,39,50]]]},{name:"夏至",theme:[[[203,82,62],[177,59,46],[149,48,46],[130,35,39]],[[178,182,182],[167,170,161],[122,123,120],[104,106,103]],[[240,194,162],[219,156,94],[217,136,61],[204,93,32]],[[245,243,242],[234,229,227],[223,224,217],[212,211,202]]]},{name:"小暑",theme:[[[245,176,135],[241,143,96],[239,132,93],[237,109,70]],[[224,223,198],[191,185,156],[169,159,112],[135,125,82]],[[149,64,36],[135,52,36],[102,43,31],[76,30,26]],[[16,104,152],[18,80,123],[6,67,111],[0,52,69]]]},{name:"大暑",theme:[[[227,173,185],[207,146,158],[178,119,119],[163,95,101]],[[237,241,187],[227,235,152],[216,222,138],[205,209,113]],[[212,191,137],[191,166,112],[170,142,89],[137,109,71]],[[190,210,187],[155,180,150],[129,163,128],[105,142,106]]]},{name:"立秋",theme:[[[136,171,218],[111,148,205],[89,118,186],[46,89,167]],[[152,182,194],[127,159,175],[102,143,139],[84,118,137]],[[239,239,239],[216,209,197],[198,190,177],[172,159,138]],[[192,208,157],[147,143,76],[127,117,76],[89,83,51]]]},{name:"處暑",theme:[[[240,207,227],[228,184,213],[206,147,192],[186,121,177]],[[201,207,193],[168,183,140],[144,160,125],[108,134,80]],[[162,210,226],[135,192,202],[90,164,174],[16,139,150]],[[234,216,154],[213,180,92],[191,156,70],[170,133,52]]]},{name:"白露",theme:[[[245,242,233],[234,228,209],[223,214,184],[213,200,160]],[[134,144,138],[107,125,115],[85,95,77],[69,73,61]],[[211,203,197],[200,181,179],[146,129,135],[89,76,87]],[[196,183,152],[165,138,95],[124,98,63],[100,77,49]]]},{name:"秋分",theme:[[[213,227,212],[202,215,197],[190,202,183],[179,189,169]],[[192,173,94],[170,150,73],[143,61,44],[104,54,50]],[[74,148,196],[65,130,164],[50,120,138],[0,109,135]],[[234,238,241],[212,221,225],[189,203,210],[178,191,195]]]},{name:"寒露",theme:[[[166,186,177],[129,157,142],[119,138,119],[95,118,106]],[[221,176,120],[218,146,51],[188,110,55],[159,82,33]],[[139,163,199],[0,61,116],[25,50,95],[26,40,71]],[[236,217,199],[225,193,153],[198,162,104],[179,147,75]]]},{name:"霜降",theme:[[[209,41,32],[171,29,34],[143,29,34],[99,18,22]],[[189,178,178],[145,130,143],[106,91,109],[92,79,85]],[[248,198,181],[218,158,140],[215,127,102],[177,90,67]],[[223,215,194],[212,193,166],[190,167,139],[153,128,108]]]},{name:"立冬",theme:[[[255,251,199],[247,238,173],[236,224,147],[214,197,96]],[[136,191,184],[93,163,157],[61,142,134],[32,104,100]],[[158,140,107],[136,118,87],[109,92,61],[90,76,59]],[[168,135,135],[158,105,109],[129,71,76],[102,43,47]]]},{name:"小雪",theme:[[[222,130,167],[204,115,160],[185,90,137],[176,67,111]],[[230,119,98],[221,107,79],[210,71,53],[185,58,38]],[[212,229,239],[188,212,231],[163,187,219],[138,171,204]],[[158,131,104],[144,108,74],[124,91,62],[114,69,58]]]},{name:"大雪",theme:[[[239,196,206],[206,136,146],[195,92,106],[176,69,82]],[[212,211,193],[191,193,169],[169,160,130],[117,108,75]],[[120,138,111],[93,114,89],[78,101,72],[63,80,59]],[[164,171,214],[117,124,187],[97,94,168],[74,75,157]]]},{name:"冬至",theme:[[[231,202,211],[217,160,179],[187,122,140],[158,78,86]],[[218,169,169],[205,115,114],[168,88,88],[124,68,73]],[[235,225,169],[225,210,121],[214,188,70],[190,138,47]],[[121,104,96],[88,82,72],[70,67,59],[49,50,44]]]},{name:"小寒",theme:[[[246,249,228],[236,235,194],[225,211,132],[202,178,114]],[[189,150,131],[149,90,66],[129,73,44],[104,54,26]],[[125,146,159],[87,100,112],[60,70,84],[21,29,41]],[[164,201,204],[108,168,175],[80,146,150],[34,107,104]]]},{name:"大寒",theme:[[[153,93,127],[129,70,98],[96,38,65],[66,11,47]],[[235,227,199],[202,197,160],[146,137,107],[102,95,77]],[[221,197,184],[190,168,157],[143,109,95],[105,75,60]],[[200,182,187],[156,141,155],[157,133,143],[118,85,93]]]}];var $e=r(802);let Je,Qe;function et(){(()=>{const{theme:r}=(0,t.ei)(qe);let i=(0,t.TV)(r.map((e=>(0,t.ei)(e))));i=i.sort(((e,t)=>o.kE(t)-o.kE(e)));const s=new d.Z([192,158,121]);s.hue+=10*(0,t.MX)(-1,1),s.saturation-=(0,t.MX)(.15),s.lightness+=(0,t.MX)(.2),n.Z.bgColor=s.value;const a=new d.Z(i[2]);if((0,t.MX)()<.2&&(a.saturation=Math.max(a.saturation,(0,t.MX)(.9,.7)),a.lightness=Math.max(a.lightness,.5)),n.Z.color0=i[0],n.Z.color1=i[1],n.Z.color2=a.value,(0,t.MX)()<.1){const e=(0,t.ei)($e.Z);for(let t in e)n.Z[t]=e[t]}Qe=document.createElement("canvas"),Qe.id="main-canvas",document.body.appendChild(Qe),e.GL.init(Qe,{alpha:!1,preserveDrawingBuffer:!0}),Je=new He;let c=!1;const u=document.querySelector(".webcam"),l=document.querySelector(".webcam-debug"),h=()=>{c=!c,u.style.display=c?"block":"none",l.style.display=c?"block":"none"};window.addEventListener("keydown",(e=>{"w"===e.key&&h(),"f"===e.key&&(document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),localStorage.removeItem("isFullscreen")):(document.documentElement.requestFullscreen(),localStorage.setItem("isFullscreen","true")))})),h()})()}document.fonts.ready.then((function(){var e;new Promise(((t,n)=>{const o=document.body.querySelector(".Loading-Bar");console.log("Load Assets",We),We.length>0?(document.body.classList.add("isLoading"),new(Ke())({assets:We}).on("error",(e=>{console.log("Error :",e)})).on("progress",(e=>{o&&(o.style.width=100*e+"%")})).on("complete",(n=>{o&&(o.style.width="100%"),Ye(n),setTimeout((()=>{document.body.classList.remove("isLoading"),t(e)}),500)})).start()):t(e)})).then(et,t.H)})),window.addEventListener("load",(()=>{"true"===localStorage.getItem("isFullscreen")&&document.documentElement.requestFullscreen().catch((e=>{console.log(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}))}))})()})();